
Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.

2025-06-25 11:32:20.577 Port 8501 is already in use

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://172.28.0.12:8501
  External URL: http://35.185.223.58:8501


Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.

2025-06-26 09:41:49.975 Port 8501 is already in use
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m49[0m in [92m<module>[0m                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 46 [0m[2m│   [0m[94mfrom[0m[90m [0m[4;96msklearn[0m[4;96m.[0m[4;96mfeature_extraction[0m[4;96m.[0m[4;96mtext[0m[90m [0m[94mimport[0m TfidfVectorizer, ENGLISH_STOP_ [31m [0m
[31m [0m   [2m 47 [0m[2m│   [0m[94mfrom[0m[90m [0m[4;96msklearn[0m[4;96m.[0m[4;96mmetrics[0m[4;96m.[0m[4;96mpairwise[0m[90m [0m[94mimport[0m cosine_similarity                     [31m [0m
[31m [0m   [2m 48 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m 49 [2m│   [0m[1;2;4m# --- Text cl[0m[2meaning function ---[0m                                           [31m [0m
[31m [0m   [2m 50 [0m[2m│   [0m[94mdef[0m[90m [0m[92mclean_text[0m(text):                                                      [31m [0m
[31m [0m   [2m 51 [0m[2m│   │   [0m[94mif[0m pd.isna(text):                                                      [31m [0m
[31m [0m   [2m 52 [0m[2m│   │   │   [0m[94mreturn[0m [33m"[0m[33m"[0m                                                          [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mModuleNotFoundError: [0mNo module named [32m'gensim'[0m
  Stopping...
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
  File "/usr/local/lib/python3.11/dist-packages/watchdog/observers/api.py", line 213, in run
    self.dispatch_events(self.event_queue)
  File "/usr/local/lib/python3.11/dist-packages/watchdog/observers/api.py", line 391, in dispatch_events
    handler.dispatch(event)
  File "/usr/local/lib/python3.11/dist-packages/watchdog/events.py", line 217, in dispatch
    getattr(self, f"on_{event.event_type}")(event)
  File "/usr/local/lib/python3.11/dist-packages/streamlit/watcher/event_based_path_watcher.py", line 417, in on_modified
    self.handle_path_change_event(event)
  File "/usr/local/lib/python3.11/dist-packages/streamlit/watcher/event_based_path_watcher.py", line 368, in handle_path_change_event
    for path, info in self._watched_paths.items():
RuntimeError: dictionary changed size during iteration

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://172.28.0.12:8501
  External URL: http://35.185.223.58:8501


Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.

2025-06-26 10:06:08.369 Port 8501 is already in use
2025-06-26 10:06:14.398 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 178
    st.subheader("🔍 Explore 'High' Fit Companies (Gensim TF-IDF Similarity)")
IndentationError: unexpected indent
2025-06-26 10:06:14.401 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
                                                                 [31m [0m
[31m [0m   [2m126 [0m[2m│   [0m[2m# ---- Evaluate All Models ----[0m                                            [31m [0m
[31m [0m   [2m127 [0m[2m│   [0mresults = {}                                                               [31m [0m
[31m [0m [31m❱ [0m128 [2m│   [0m[94mfor[0m name, model [95min[0m [1;4mmodels[0m.items():                                         [31m [0m
[31m [0m   [2m129 [0m[2m│   │   [0mmodel.fit(X_train, y_train)                                            [31m [0m
[31m [0m   [2m130 [0m[2m│   │   [0my_pred = model.predict(X_test)                                         [31m [0m
[31m [0m   [2m131 [0m[2m│   │   [0mprecision = precision_score(y_test, y_pred, average=[33m'[0m[33mweighted[0m[33m'[0m, zero_d [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'models'[0m is not defined
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m129[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m126 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m127 [0m[2m│   [0m[2m# ---- Evaluate All Models ----[0m                                            [31m [0m
[31m [0m   [2m128 [0m[2m│   [0mresults = {}                                                               [31m [0m
[31m [0m [31m❱ [0m129 [2m│   [0m[94mfor[0m name, model [95min[0m [1;4mmodels[0m.items():                                         [31m [0m
[31m [0m   [2m130 [0m[2m│   │   [0mmodel.fit(X_train, y_train)                                            [31m [0m
[31m [0m   [2m131 [0m[2m│   │   [0my_pred = model.predict(X_test)                                         [31m [0m
[31m [0m   [2m132 [0m[2m│   │   [0mprecision = precision_score(y_test, y_pred, average=[33m'[0m[33mweighted[0m[33m'[0m, zero_d [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'models'[0m is not defined
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m118[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m115 [0m[2m│   [0mindex = similarities.SparseMatrixSimilarity(corpus_tfidf, num_features=[96mlen[0m [31m [0m
[31m [0m   [2m116 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m117 [0m[2m│   [0m[2m# --- Charts ----- [0m                                                        [31m [0m
[31m [0m [31m❱ [0m118 [2m│   [0m[94mfor[0m name, model [95min[0m [1;4mmodels[0m.items():                                         [31m [0m
[31m [0m   [2m119 [0m[2m│     [0mmodels = {                                                               [31m [0m
[31m [0m   [2m120 [0m[2m│   [0m[33m"[0m[33mLogistic Regression[0m[33m"[0m: LogisticRegression(max_iter=[94m1000[0m, class_weight=[33m'[0m[33mbal[0m [31m [0m
[31m [0m   [2m121 [0m[2m│   [0m[33m"[0m[33mK-Nearest Neighbors[0m[33m"[0m: KNeighborsClassifier(n_neighbors=[94m5[0m),                [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'models'[0m is not defined
2025-06-26 10:05:41.575 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 177
    st.subheader("🔍 Explore 'High' Fit Companies (Gensim TF-IDF Similarity)")
IndentationError: unexpected indent
2025-06-26 10:05:41.588 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 10:08:43.226 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m121[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m118 [0m[2m│   [0m[2m# ---- Define models BEFORE using them ----[0m                                [31m [0m
[31m [0m   [2m119 [0m[2m│   [0mmodels = {                                                                 [31m [0m
[31m [0m   [2m120 [0m[2m│   [0m[33m"[0m[33mLogistic Regression[0m[33m"[0m: LogisticRegression(max_iter=[94m1000[0m, class_weight=[33m'[0m[33mbal[0m [31m [0m
[31m [0m [31m❱ [0m121 [2m│   [0m[33m"[0m[33mK-Nearest Neighbors[0m[33m"[0m: [1;4mKNeighborsClassifier[0m(n_neighbors=[94m5[0m),                [31m [0m
[31m [0m   [2m122 [0m[2m│   [0m[33m"[0m[33mDecision Tree[0m[33m"[0m: DecisionTreeClassifier(class_weight=[33m'[0m[33mbalanced[0m[33m'[0m),          [31m [0m
[31m [0m   [2m123 [0m[2m│   [0m[33m"[0m[33mRandom Forest[0m[33m"[0m: RandomForestClassifier(n_estimators=[94m200[0m, class_weight=[33m'[0m[33mba[0m [31m [0m
[31m [0m   [2m124 [0m[2m│   [0m[33m"[0m[33mSupport Vector Machine[0m[33m"[0m: SVC(probability=[94mTrue[0m, class_weight=[33m'[0m[33mbalanced[0m[33m'[0m)}  [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'KNeighborsClassifier'[0m is not defined
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m123[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m120 [0m[2m│   [0mmodels = {                                                                 [31m [0m
[31m [0m   [2m121 [0m[2m│   [0m[33m"[0m[33mLogistic Regression[0m[33m"[0m: LogisticRegression(max_iter=[94m1000[0m, class_weight=[33m'[0m[33mbal[0m [31m [0m
[31m [0m   [2m122 [0m[2m│   [0m[33m"[0m[33mK-Nearest Neighbors[0m[33m"[0m: KNeighborsClassifier(n_neighbors=[94m5[0m),                [31m [0m
[31m [0m [31m❱ [0m123 [2m│   [0m[33m"[0m[33mDecision Tree[0m[33m"[0m: [1;4mDecisionTreeClassifier[0m(class_weight=[33m'[0m[33mbalanced[0m[33m'[0m),          [31m [0m
[31m [0m   [2m124 [0m[2m│   [0m[33m"[0m[33mRandom Forest[0m[33m"[0m: RandomForestClassifier(n_estimators=[94m200[0m, class_weight=[33m'[0m[33mba[0m [31m [0m
[31m [0m   [2m125 [0m[2m│   [0m[33m"[0m[33mSupport Vector Machine[0m[33m"[0m: SVC(probability=[94mTrue[0m, class_weight=[33m'[0m[33mbalanced[0m[33m'[0m)}  [31m [0m
[31m [0m   [2m126 [0m[2m│   [0m[2m# ---- Recalculate cosine feature and split ----[0m                           [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'DecisionTreeClassifier'[0m is not defined
2025-06-26 10:21:36.219 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 183
    st.subheader("🔍 Explore 'High' Fit Companies (Gensim TF-IDF Similarity)")
IndentationError: unexpected indent
2025-06-26 10:21:36.222 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 10:21:55.894 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://172.28.0.12:8501
  External URL: http://34.170.244.55:8501

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m227[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m224 [0m[2m│   [0m[94mimport[0m[90m [0m[4;96mseaborn[0m[90m [0m[94mas[0m[90m [0m[4;96msns[0m                                                      [31m [0m
[31m [0m   [2m225 [0m[2m│   [0m[94mimport[0m[90m [0m[4;96mre[0m                                                                  [31m [0m
[31m [0m   [2m226 [0m[2m│   [0m[94mimport[0m[90m [0m[4;96mopenpyxl[0m                                                            [31m [0m
[31m [0m [31m❱ [0m227 [2m│   [0m[1;4;94mfrom[0m[1;4;90m [0m[1;4;96munderthesea[0m[1;4;90m [0m[1;4;94mimport[0m[1;4m word_tokenize[0m                                      [31m [0m
[31m [0m   [2m228 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m229 [0m[2m│   [0m[94mfrom[0m[90m [0m[4;96msklearn[0m[4;96m.[0m[4;96mmodel_selection[0m[90m [0m[94mimport[0m train_test_split                       [31m [0m
[31m [0m   [2m230 [0m[2m│   [0m[94mfrom[0m[90m [0m[4;96msklearn[0m[4;96m.[0m[4;96mfeature_extraction[0m[4;96m.[0m[4;96mtext[0m[90m [0m[94mimport[0m TfidfVectorizer                [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mModuleNotFoundError: [0mNo module named [32m'underthesea'[0m
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m253[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m250 [0m[2m│   │   [0mdata = data.merge(overview_companies[[[33m"[0m[33mcompany_id[0m[33m"[0m, [33m"[0m[33mCompany Name[0m[33m"[0m, [33m"[0m[33mC[0m [31m [0m
[31m [0m   [2m251 [0m[2m│   │   [0m[94mreturn[0m data.dropna(subset=[[33m'[0m[33mReview[0m[33m'[0m])                                  [31m [0m
[31m [0m   [2m252 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m253 [2m│   [0mdf_reviews = [1;4mload_review_data()[0m                                            [31m [0m
[31m [0m   [2m254 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m255 [0m[2m│   [0m[94mwith[0m [96mopen[0m([33m"[0m[33mDu lieu cung cap/files/vietnamese-stopwords.txt[0m[33m"[0m, encoding=[33m"[0m[33mutf[0m [31m [0m
[31m [0m   [2m256 [0m[2m│   │   [0mstopwords = [96mset[0m(f.read().splitlines())                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m219[0m [31m [0m
[31m [0m in [92m__call__[0m                                                                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m261[0m [31m [0m
[31m [0m in [92m_get_or_create_cached_value[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m320[0m [31m [0m
[31m [0m in [92m_handle_cache_miss[0m                                                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m242[0m in [92mload_review_data[0m                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m239 [0m[2m│   [0m[2m# --- Load data from Google Drive links ---[0m                                [31m [0m
[31m [0m   [2m240 [0m[2m│   [0m[1;95m@st[0m.cache_data                                                             [31m [0m
[31m [0m   [2m241 [0m[2m│   [0m[94mdef[0m[90m [0m[92mload_review_data[0m():                                                    [31m [0m
[31m [0m [31m❱ [0m242 [2m│   │   [0mreviews = [1;4mpd.read_csv([0m[1;4;33m"[0m[1;4;33mhttps://docs.google.com/spreadsheets/d/16O3kPOc[0m [31m [0m
[31m [0m   [2m243 [0m[2m│   │   [0moverview_reviews = pd.read_csv([33m"[0m[33mhttps://docs.google.com/spreadsheets/d[0m [31m [0m
[31m [0m   [2m244 [0m[2m│   │   [0moverview_companies = pd.read_csv([33m"[0m[33mhttps://docs.google.com/spreadsheets[0m [31m [0m
[31m [0m   [2m245 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/io/parsers/[0m[1;33mreaders.py[0m:[94m1026[0m in         [31m [0m
[31m [0m [92mread_csv[0m                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1023 [0m[2m│   [0m)                                                                         [31m [0m
[31m [0m   [2m1024 [0m[2m│   [0mkwds.update(kwds_defaults)                                                [31m [0m
[31m [0m   [2m1025 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m [31m❱ [0m1026 [2m│   [0m[94mreturn[0m [1;4m_read(filepath_or_buffer, kwds)[0m                                    [31m [0m
[31m [0m   [2m1027 [0m                                                                              [31m [0m
[31m [0m   [2m1028 [0m                                                                              [31m [0m
[31m [0m   [2m1029 [0m[2m# iterator=True -> TextFileReader[0m                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/io/parsers/[0m[1;33mreaders.py[0m:[94m620[0m in [92m_read[0m    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 617 [0m[2m│   [0m_validate_names(kwds.get([33m"[0m[33mnames[0m[33m"[0m, [94mNone[0m))                                  [31m [0m
[31m [0m   [2m 618 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m 619 [0m[2m│   [0m[2m# Create the parser.[0m                                                      [31m [0m
[31m [0m [31m❱ [0m 620 [2m│   [0mparser = [1;4mTextFileReader(filepath_or_buffer, **kwds)[0m                       [31m [0m
[31m [0m   [2m 621 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m 622 [0m[2m│   [0m[94mif[0m chunksize [95mor[0m iterator:                                                 [31m [0m
[31m [0m   [2m 623 [0m[2m│   │   [0m[94mreturn[0m parser                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/io/parsers/[0m[1;33mreaders.py[0m:[94m1620[0m in         [31m [0m
[31m [0m [92m__init__[0m                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1617 [0m[2m│   │   │   [0m[96mself[0m.options[[33m"[0m[33mhas_index_names[0m[33m"[0m] = kwds[[33m"[0m[33mhas_index_names[0m[33m"[0m]         [31m [0m
[31m [0m   [2m1618 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1619 [0m[2m│   │   [0m[96mself[0m.handles: IOHandles | [94mNone[0m = [94mNone[0m                                 [31m [0m
[31m [0m [31m❱ [0m1620 [2m│   │   [0m[96mself[0m._engine = [1;4;96mself[0m[1;4m._make_engine(f, [0m[1;4;96mself[0m[1;4m.engine)[0m                      [31m [0m
[31m [0m   [2m1621 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1622 [0m[2m│   [0m[94mdef[0m[90m [0m[92mclose[0m([96mself[0m) -> [94mNone[0m:                                                  [31m [0m
[31m [0m   [2m1623 [0m[2m│   │   [0m[94mif[0m [96mself[0m.handles [95mis[0m [95mnot[0m [94mNone[0m:                                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/io/parsers/[0m[1;33mreaders.py[0m:[94m1880[0m in         [31m [0m
[31m [0m [92m_make_engine[0m                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1877 [0m[2m│   │   │   │   [0mis_text = [94mFalse[0m                                               [31m [0m
[31m [0m   [2m1878 [0m[2m│   │   │   │   [0m[94mif[0m [33m"[0m[33mb[0m[33m"[0m [95mnot[0m [95min[0m mode:                                           [31m [0m
[31m [0m   [2m1879 [0m[2m│   │   │   │   │   [0mmode += [33m"[0m[33mb[0m[33m"[0m                                               [31m [0m
[31m [0m [31m❱ [0m1880 [2m│   │   │   [0m[96mself[0m.handles = get_handle(                                        [31m [0m
[31m [0m   [2m1881 [0m[2m│   │   │   │   [0mf,                                                            [31m [0m
[31m [0m   [2m1882 [0m[2m│   │   │   │   [0mmode,                                                         [31m [0m
[31m [0m   [2m1883 [0m[2m│   │   │   │   [0mencoding=[96mself[0m.options.get([33m"[0m[33mencoding[0m[33m"[0m, [94mNone[0m),                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/io/[0m[1;33mcommon.py[0m:[94m728[0m in [92mget_handle[0m        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 725 [0m[2m│   │   [0mcodecs.lookup_error(errors)                                           [31m [0m
[31m [0m   [2m 726 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m 727 [0m[2m│   [0m[2m# open URLs[0m                                                               [31m [0m
[31m [0m [31m❱ [0m 728 [2m│   [0mioargs = _get_filepath_or_buffer(                                         [31m [0m
[31m [0m   [2m 729 [0m[2m│   │   [0mpath_or_buf,                                                          [31m [0m
[31m [0m   [2m 730 [0m[2m│   │   [0mencoding=encoding,                                                    [31m [0m
[31m [0m   [2m 731 [0m[2m│   │   [0mcompression=compression,                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/io/[0m[1;33mcommon.py[0m:[94m384[0m in                   [31m [0m
[31m [0m [92m_get_filepath_or_buffer[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 381 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m 382 [0m[2m│   │   [0m[2m# assuming storage_options is to be interpreted as headers[0m            [31m [0m
[31m [0m   [2m 383 [0m[2m│   │   [0mreq_info = urllib.request.Request(filepath_or_buffer, headers=storage [31m [0m
[31m [0m [31m❱ [0m 384 [2m│   │   [0m[94mwith[0m [1;4murlopen(req_info)[0m [94mas[0m req:                                        [31m [0m
[31m [0m   [2m 385 [0m[2m│   │   │   [0mcontent_encoding = req.headers.get([33m"[0m[33mContent-Encoding[0m[33m"[0m, [94mNone[0m)      [31m [0m
[31m [0m   [2m 386 [0m[2m│   │   │   [0m[94mif[0m content_encoding == [33m"[0m[33mgzip[0m[33m"[0m:                                    [31m [0m
[31m [0m   [2m 387 [0m[2m│   │   │   │   [0m[2m# Override compression based on Content-Encoding header[0m       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/io/[0m[1;33mcommon.py[0m:[94m289[0m in [92murlopen[0m           [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 286 [0m[2;33m│   [0m[33m"""[0m                                                                       [31m [0m
[31m [0m   [2m 287 [0m[2m│   [0m[94mimport[0m[90m [0m[4;96murllib[0m[4;96m.[0m[4;96mrequest[0m                                                     [31m [0m
[31m [0m   [2m 288 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m [31m❱ [0m 289 [2m│   [0m[94mreturn[0m [1;4murllib.request.urlopen(*args, **kwargs)[0m                            [31m [0m
[31m [0m   [2m 290 [0m                                                                              [31m [0m
[31m [0m   [2m 291 [0m                                                                              [31m [0m
[31m [0m   [2m 292 [0m[94mdef[0m[90m [0m[92mis_fsspec_url[0m(url: FilePath | BaseBuffer) -> [96mbool[0m:                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/lib/python3.11/urllib/[0m[1;33mrequest.py[0m:[94m216[0m in [92murlopen[0m                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 213 [0m[2m│   │   [0m_opener = opener = build_opener()                                     [31m [0m
[31m [0m   [2m 214 [0m[2m│   [0m[94melse[0m:                                                                     [31m [0m
[31m [0m   [2m 215 [0m[2m│   │   [0mopener = _opener                                                      [31m [0m
[31m [0m [31m❱ [0m 216 [2m│   [0m[94mreturn[0m [1;4mopener.open(url, data, timeout)[0m                                    [31m [0m
[31m [0m   [2m 217 [0m                                                                              [31m [0m
[31m [0m   [2m 218 [0m[94mdef[0m[90m [0m[92minstall_opener[0m(opener):                                                   [31m [0m
[31m [0m   [2m 219 [0m[2m│   [0m[94mglobal[0m _opener                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/lib/python3.11/urllib/[0m[1;33mrequest.py[0m:[94m525[0m in [92mopen[0m                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 522 [0m[2m│   │   [0mmeth_name = protocol+[33m"[0m[33m_response[0m[33m"[0m                                      [31m [0m
[31m [0m   [2m 523 [0m[2m│   │   [0m[94mfor[0m processor [95min[0m [96mself[0m.process_response.get(protocol, []):             [31m [0m
[31m [0m   [2m 524 [0m[2m│   │   │   [0mmeth = [96mgetattr[0m(processor, meth_name)                              [31m [0m
[31m [0m [31m❱ [0m 525 [2m│   │   │   [0mresponse = [1;4mmeth(req, response)[0m                                    [31m [0m
[31m [0m   [2m 526 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m 527 [0m[2m│   │   [0m[94mreturn[0m response                                                       [31m [0m
[31m [0m   [2m 528 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/lib/python3.11/urllib/[0m[1;33mrequest.py[0m:[94m634[0m in [92mhttp_response[0m                           [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 631 [0m[2m│   │   [0m[2m# According to RFC 2616, "2xx" code indicates that the client's[0m       [31m [0m
[31m [0m   [2m 632 [0m[2m│   │   [0m[2m# request was successfully received, understood, and accepted.[0m        [31m [0m
[31m [0m   [2m 633 [0m[2m│   │   [0m[94mif[0m [95mnot[0m ([94m200[0m <= code < [94m300[0m):                                           [31m [0m
[31m [0m [31m❱ [0m 634 [2m│   │   │   [0mresponse = [1;4;96mself[0m[1;4m.parent.error([0m                                     [31m [0m
[31m [0m   [2m 635 [0m[1;2;4m│   │   │   │   [0m[1;4;33m'[0m[1;4;33mhttp[0m[1;4;33m'[0m[1;4m, request, response, code, msg, hdrs)[0m                   [31m [0m
[31m [0m   [2m 636 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m 637 [0m[2m│   │   [0m[94mreturn[0m response                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/lib/python3.11/urllib/[0m[1;33mrequest.py[0m:[94m563[0m in [92merror[0m                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 560 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m 561 [0m[2m│   │   [0m[94mif[0m http_err:                                                          [31m [0m
[31m [0m   [2m 562 [0m[2m│   │   │   [0margs = ([96mdict[0m, [33m'[0m[33mdefault[0m[33m'[0m, [33m'[0m[33mhttp_error_default[0m[33m'[0m) + orig_args        [31m [0m
[31m [0m [31m❱ [0m 563 [2m│   │   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m._call_chain(*args)[0m                                    [31m [0m
[31m [0m   [2m 564 [0m                                                                              [31m [0m
[31m [0m   [2m 565 [0m[2m# XXX probably also want an abstract factory that knows when it makes[0m         [31m [0m
[31m [0m   [2m 566 [0m[2m# sense to skip a superclass in favor of a subclass and when it might[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/lib/python3.11/urllib/[0m[1;33mrequest.py[0m:[94m496[0m in [92m_call_chain[0m                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 493 [0m[2m│   │   [0mhandlers = chain.get(kind, ())                                        [31m [0m
[31m [0m   [2m 494 [0m[2m│   │   [0m[94mfor[0m handler [95min[0m handlers:                                              [31m [0m
[31m [0m   [2m 495 [0m[2m│   │   │   [0mfunc = [96mgetattr[0m(handler, meth_name)                                [31m [0m
[31m [0m [31m❱ [0m 496 [2m│   │   │   [0mresult = [1;4mfunc(*args)[0m                                              [31m [0m
[31m [0m   [2m 497 [0m[2m│   │   │   [0m[94mif[0m result [95mis[0m [95mnot[0m [94mNone[0m:                                            [31m [0m
[31m [0m   [2m 498 [0m[2m│   │   │   │   [0m[94mreturn[0m result                                                 [31m [0m
[31m [0m   [2m 499 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/lib/python3.11/urllib/[0m[1;33mrequest.py[0m:[94m643[0m in [92mhttp_error_default[0m                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 640 [0m                                                                              [31m [0m
[31m [0m   [2m 641 [0m[94mclass[0m[90m [0m[4;92mHTTPDefaultErrorHandler[0m(BaseHandler):                                   [31m [0m
[31m [0m   [2m 642 [0m[2m│   [0m[94mdef[0m[90m [0m[92mhttp_error_default[0m([96mself[0m, req, fp, code, msg, hdrs):                   [31m [0m
[31m [0m [31m❱ [0m 643 [2m│   │   [0m[1;4;94mraise[0m[1;4m HTTPError(req.full_url, code, msg, hdrs, fp)[0m                    [31m [0m
[31m [0m   [2m 644 [0m                                                                              [31m [0m
[31m [0m   [2m 645 [0m[94mclass[0m[90m [0m[4;92mHTTPRedirectHandler[0m(BaseHandler):                                       [31m [0m
[31m [0m   [2m 646 [0m[2m│   [0m[2m# maximum number of redirections to any single URL[0m                        [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mHTTPError: [0mHTTP Error [1;36m401[0m: Unauthorized
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m253[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m250 [0m[2m│   │   [0mdata = data.merge(overview_companies[[[33m"[0m[33mcompany_id[0m[33m"[0m, [33m"[0m[33mCompany Name[0m[33m"[0m, [33m"[0m[33mC[0m [31m [0m
[31m [0m   [2m251 [0m[2m│   │   [0m[94mreturn[0m data.dropna(subset=[[33m'[0m[33mReview[0m[33m'[0m])                                  [31m [0m
[31m [0m   [2m252 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m253 [2m│   [0mdf_reviews = [1;4mload_review_data()[0m                                            [31m [0m
[31m [0m   [2m254 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m255 [0m[2m│   [0m[94mwith[0m [96mopen[0m([33m"[0m[33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_[0m [31m [0m
[31m [0m   [2m256 [0m[2m│   │   [0mstopwords = [96mset[0m(f.read().splitlines())                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m219[0m [31m [0m
[31m [0m in [92m__call__[0m                                                                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m261[0m [31m [0m
[31m [0m in [92m_get_or_create_cached_value[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m320[0m [31m [0m
[31m [0m in [92m_handle_cache_miss[0m                                                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m251[0m in [92mload_review_data[0m                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m248 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m249 [0m[2m│   │   [0mdata = reviews.merge(overview_reviews[[[33m"[0m[33mcompany_id[0m[33m"[0m, [33m"[0m[33mOverall rating[0m[33m"[0m] [31m [0m
[31m [0m   [2m250 [0m[2m│   │   [0mdata = data.merge(overview_companies[[[33m"[0m[33mcompany_id[0m[33m"[0m, [33m"[0m[33mCompany Name[0m[33m"[0m, [33m"[0m[33mC[0m [31m [0m
[31m [0m [31m❱ [0m251 [2m│   │   [0m[94mreturn[0m [1;4mdata.dropna(subset=[[0m[1;4;33m'[0m[1;4;33mReview[0m[1;4;33m'[0m[1;4m])[0m                                  [31m [0m
[31m [0m   [2m252 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m253 [0m[2m│   [0mdf_reviews = load_review_data()                                            [31m [0m
[31m [0m   [2m254 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/core/[0m[1;33mframe.py[0m:[94m6670[0m in [92mdropna[0m          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 6667 [0m[2m│   │   │   [0mindices = ax.get_indexer_for(subset)                             [31m [0m
[31m [0m   [2m 6668 [0m[2m│   │   │   [0mcheck = indices == -[94m1[0m                                            [31m [0m
[31m [0m   [2m 6669 [0m[2m│   │   │   [0m[94mif[0m check.any():                                                  [31m [0m
[31m [0m [31m❱ [0m 6670 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mKeyError[0m[1;4m(np.array(subset)[check].tolist())[0m             [31m [0m
[31m [0m   [2m 6671 [0m[2m│   │   │   [0magg_obj = [96mself[0m.take(indices, axis=agg_axis)                      [31m [0m
[31m [0m   [2m 6672 [0m[2m│   │   [0m                                                                     [31m [0m
[31m [0m   [2m 6673 [0m[2m│   │   [0m[94mif[0m thresh [95mis[0m [95mnot[0m lib.no_default:                                     [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mKeyError: [0m[1m[[0m[32m'Review'[0m[1m][0m
2025-06-26 17:43:42.824 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 251
    st.write("📎 Available columns:", data.columns.tolist())
IndentationError: unexpected indent
2025-06-26 17:43:42.835 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:44:19.647 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 251
    st.write("📎 Available columns:", data.columns.tolist())
IndentationError: unexpected indent
2025-06-26 17:44:19.649 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:45:31.140 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 17:45:42.598 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 253
    st.write("📎 Available columns:", data.columns.tolist())
IndentationError: unexpected indent
2025-06-26 17:45:42.600 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:46:31.267 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 17:46:35.285 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 258
    st.write("📎 Available columns:", data.columns.tolist())
IndentationError: unexpected indent
2025-06-26 17:46:35.287 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:46:47.748 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 258
    st.write("📎 Available columns:", data.columns.tolist())
IndentationError: unexpected indent
2025-06-26 17:46:47.750 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:47:27.922 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 17:47:32.698 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 254
    data = reviews.merge(overview_reviews[["company_id", "Overall rating"]], left_on="id", right_on="company_id", how="left")
IndentationError: unexpected indent
2025-06-26 17:47:32.700 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:48:21.513 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 17:48:25.517 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 257
    overview_companies = overview_companies.rename(columns={"id": "company_id"})        data = reviews.merge(overview_reviews[["company_id", "Overall rating"]], left_on="id", right_on="company_id", how="left")        data = data.merge(overview_companies[["company_id", "Company Name", "Company Type", "Company size"]], on="company_id", how="left")        st.write("📎 Available columns:", data.columns.tolist())
                                                                                        ^^^^
SyntaxError: invalid syntax
2025-06-26 17:48:25.518 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:49:37.942 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 17:49:44.879 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 259
    data = data.merge(overview_companies[["company_id", "Company Name", "Company Type", "Company size"]], on="company_id", how="left")        st.write("📎 Available columns:", data.columns.tolist())
                                                                                                                                              ^^
SyntaxError: invalid syntax
2025-06-26 17:49:44.881 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:49:56.811 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
Requirement already satisfied: underthesea in /usr/local/lib/python3.11/dist-packages (6.8.4)
Requirement already satisfied: Click>=6.0 in /usr/local/lib/python3.11/dist-packages (from underthesea) (8.2.1)
Requirement already satisfied: python-crfsuite>=0.9.6 in /usr/local/lib/python3.11/dist-packages (from underthesea) (0.9.11)
Requirement already satisfied: nltk in /usr/local/lib/python3.11/dist-packages (from underthesea) (3.9.1)
Requirement already satisfied: tqdm in /usr/local/lib/python3.11/dist-packages (from underthesea) (4.67.1)
Requirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (from underthesea) (2.32.3)
Requirement already satisfied: joblib in /usr/local/lib/python3.11/dist-packages (from underthesea) (1.5.1)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.11/dist-packages (from underthesea) (1.6.1)
Requirement already satisfied: PyYAML in /usr/local/lib/python3.11/dist-packages (from underthesea) (6.0.2)
Requirement already satisfied: underthesea-core==1.0.4 in /usr/local/lib/python3.11/dist-packages (from underthesea) (1.0.4)
Requirement already satisfied: regex>=2021.8.3 in /usr/local/lib/python3.11/dist-packages (from nltk->underthesea) (2024.11.6)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests->underthesea) (3.4.2)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests->underthesea) (3.10)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests->underthesea) (2.4.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests->underthesea) (2025.6.15)
Requirement already satisfied: numpy>=1.19.5 in /usr/local/lib/python3.11/dist-packages (from scikit-learn->underthesea) (1.26.4)
Requirement already satisfied: scipy>=1.6.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn->underthesea) (1.13.1)
Requirement already satisfied: threadpoolctl>=3.1.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn->underthesea) (3.6.0)
2025-06-26 17:51:10.707 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 263
    if 'Review' not in data.columns:
IndentationError: unexpected indent
2025-06-26 17:51:10.712 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:56:09.027 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 17:56:19.536 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 371
    import streamlit as st
IndentationError: unexpected indent
2025-06-26 17:56:19.539 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:56:59.043 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 371
    import streamlit as st
IndentationError: unexpected indent
2025-06-26 17:56:59.045 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 17:57:58.659 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 371
    import streamlit as st
IndentationError: unexpected indent
2025-06-26 17:57:58.661 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:01:17.904 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m292[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m289 [0m[2m│   │   │   │   [0m[94mreturn[0m [33m"[0m[33mCần cải thiện: [0m[33m"[0m + kw.replace([33m"[0m[33m_[0m[33m"[0m, [33m"[0m[33m [0m[33m"[0m)                [31m [0m
[31m [0m   [2m290 [0m[2m│   │   [0m[94mreturn[0m [33m"[0m[33mKhông có góp ý tiêu cực[0m[33m"[0m                                       [31m [0m
[31m [0m   [2m291 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m292 [2m│   [0mdf_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] = [1;4mdf_reviews[0m[[33m'[0m[33mWhat I liked[0m[33m'[0m].apply(clean_ [31m [0m
[31m [0m   [2m293 [0m[2m│   [0mdf_reviews[[33m'[0m[33mSuggestions_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mSuggestions for improvement[0m[33m'[0m [31m [0m
[31m [0m   [2m294 [0m[2m│   [0mdf_reviews[[33m'[0m[33mtext_combined[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] + [33m'[0m[33m [0m[33m'[0m + df_ [31m [0m
[31m [0m   [2m295 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'df_reviews'[0m is not defined
2025-06-26 18:02:24.236 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 276
    df_reviews = load_review_data()
IndentationError: unexpected indent
2025-06-26 18:02:24.238 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:03:29.098 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
Requirement already satisfied: underthesea in /usr/local/lib/python3.11/dist-packages (6.8.4)
Requirement already satisfied: Click>=6.0 in /usr/local/lib/python3.11/dist-packages (from underthesea) (8.2.1)
Requirement already satisfied: python-crfsuite>=0.9.6 in /usr/local/lib/python3.11/dist-packages (from underthesea) (0.9.11)
Requirement already satisfied: nltk in /usr/local/lib/python3.11/dist-packages (from underthesea) (3.9.1)
Requirement already satisfied: tqdm in /usr/local/lib/python3.11/dist-packages (from underthesea) (4.67.1)
Requirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (from underthesea) (2.32.3)
Requirement already satisfied: joblib in /usr/local/lib/python3.11/dist-packages (from underthesea) (1.5.1)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.11/dist-packages (from underthesea) (1.6.1)
Requirement already satisfied: PyYAML in /usr/local/lib/python3.11/dist-packages (from underthesea) (6.0.2)
Requirement already satisfied: underthesea-core==1.0.4 in /usr/local/lib/python3.11/dist-packages (from underthesea) (1.0.4)
Requirement already satisfied: regex>=2021.8.3 in /usr/local/lib/python3.11/dist-packages (from nltk->underthesea) (2024.11.6)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests->underthesea) (3.4.2)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests->underthesea) (3.10)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests->underthesea) (2.4.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests->underthesea) (2025.6.15)
Requirement already satisfied: numpy>=1.19.5 in /usr/local/lib/python3.11/dist-packages (from scikit-learn->underthesea) (1.26.4)
Requirement already satisfied: scipy>=1.6.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn->underthesea) (1.13.1)
Requirement already satisfied: threadpoolctl>=3.1.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn->underthesea) (3.6.0)
2025-06-26 18:06:44.698 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 269
    return data.dropna(subset=['Review'])
IndentationError: unexpected indent
2025-06-26 18:06:44.700 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:08:11.971 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m289[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m286 [0m[2m│   │   │   │   [0m[94mreturn[0m [33m"[0m[33mCần cải thiện: [0m[33m"[0m + kw.replace([33m"[0m[33m_[0m[33m"[0m, [33m"[0m[33m [0m[33m"[0m)                [31m [0m
[31m [0m   [2m287 [0m[2m│   │   [0m[94mreturn[0m [33m"[0m[33mKhông có góp ý tiêu cực[0m[33m"[0m                                       [31m [0m
[31m [0m   [2m288 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m289 [2m│   [0mdf_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked[0m[33m'[0m].apply([1;4mclean_[0m [31m [0m
[31m [0m   [2m290 [0m[2m│   [0mdf_reviews[[33m'[0m[33mSuggestions_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mSuggestions for improvement[0m[33m'[0m [31m [0m
[31m [0m   [2m291 [0m[2m│   [0mdf_reviews[[33m'[0m[33mtext_combined[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] + [33m'[0m[33m [0m[33m'[0m + df_ [31m [0m
[31m [0m   [2m292 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'clean_text'[0m is not defined
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m289[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m286 [0m[2m│   │   │   │   [0m[94mreturn[0m [33m"[0m[33mCần cải thiện: [0m[33m"[0m + kw.replace([33m"[0m[33m_[0m[33m"[0m, [33m"[0m[33m [0m[33m"[0m)                [31m [0m
[31m [0m   [2m287 [0m[2m│   │   [0m[94mreturn[0m [33m"[0m[33mKhông có góp ý tiêu cực[0m[33m"[0m                                       [31m [0m
[31m [0m   [2m288 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m289 [2m│   [0mdf_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked[0m[33m'[0m].apply([1;4mclean_[0m [31m [0m
[31m [0m   [2m290 [0m[2m│   [0mdf_reviews[[33m'[0m[33mSuggestions_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mSuggestions for improvement[0m[33m'[0m [31m [0m
[31m [0m   [2m291 [0m[2m│   [0mdf_reviews[[33m'[0m[33mtext_combined[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] + [33m'[0m[33m [0m[33m'[0m + df_ [31m [0m
[31m [0m   [2m292 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'clean_text'[0m is not defined
2025-06-26 18:11:45.585 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 298
    if pd.isnull(text): return ""
    ^^
IndentationError: expected an indented block after function definition on line 297
2025-06-26 18:11:45.587 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:12:52.447 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:12:56.775 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 298
    if pd.isnull(text): return ""
    ^^
IndentationError: expected an indented block after function definition on line 297
2025-06-26 18:12:56.787 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:13:21.584 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m289[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m286 [0m[2m│   │   │   │   [0m[94mreturn[0m [33m"[0m[33mCần cải thiện: [0m[33m"[0m + kw.replace([33m"[0m[33m_[0m[33m"[0m, [33m"[0m[33m [0m[33m"[0m)                [31m [0m
[31m [0m   [2m287 [0m[2m│   │   [0m[94mreturn[0m [33m"[0m[33mKhông có góp ý tiêu cực[0m[33m"[0m                                       [31m [0m
[31m [0m   [2m288 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m289 [2m│   [0mdf_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked[0m[33m'[0m].apply([1;4mclean_[0m [31m [0m
[31m [0m   [2m290 [0m[2m│   [0mdf_reviews[[33m'[0m[33mSuggestions_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mSuggestions for improvement[0m[33m'[0m [31m [0m
[31m [0m   [2m291 [0m[2m│   [0mdf_reviews[[33m'[0m[33mtext_combined[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] + [33m'[0m[33m [0m[33m'[0m + df_ [31m [0m
[31m [0m   [2m292 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'clean_text'[0m is not defined
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m289[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m286 [0m[2m│   │   │   │   [0m[94mreturn[0m [33m"[0m[33mCần cải thiện: [0m[33m"[0m + kw.replace([33m"[0m[33m_[0m[33m"[0m, [33m"[0m[33m [0m[33m"[0m)                [31m [0m
[31m [0m   [2m287 [0m[2m│   │   [0m[94mreturn[0m [33m"[0m[33mKhông có góp ý tiêu cực[0m[33m"[0m                                       [31m [0m
[31m [0m   [2m288 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m289 [2m│   [0mdf_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked[0m[33m'[0m].apply([1;4mclean_[0m [31m [0m
[31m [0m   [2m290 [0m[2m│   [0mdf_reviews[[33m'[0m[33mSuggestions_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mSuggestions for improvement[0m[33m'[0m [31m [0m
[31m [0m   [2m291 [0m[2m│   [0mdf_reviews[[33m'[0m[33mtext_combined[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] + [33m'[0m[33m [0m[33m'[0m + df_ [31m [0m
[31m [0m   [2m292 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'clean_text'[0m is not defined
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m292[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m289 [0m[2m│   [0m[94mwith[0m [96mopen[0m([33m"[0m[33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_[0m [31m [0m
[31m [0m   [2m290 [0m[2m│   │   [0mstopwords = [96mset[0m(f.read().splitlines())                                 [31m [0m
[31m [0m   [2m291 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m292 [2m│   [0mdf_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked[0m[33m'[0m].apply([1;4mclean_[0m [31m [0m
[31m [0m   [2m293 [0m[2m│   [0mdf_reviews[[33m'[0m[33mSuggestions_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mSuggestions for improvement[0m[33m'[0m [31m [0m
[31m [0m   [2m294 [0m[2m│   [0mdf_reviews[[33m'[0m[33mtext_combined[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] + [33m'[0m[33m [0m[33m'[0m + df_ [31m [0m
[31m [0m   [2m295 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'clean_text'[0m is not defined
2025-06-26 18:24:25.450 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 296
    wrong_words = set(f.read().splitlines())
    ^^^^^^^^^^^
IndentationError: expected an indented block after 'with' statement on line 295
2025-06-26 18:24:25.452 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:24:44.397 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:24:48.947 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 299
    def clean_text(text):if pd.isnull(text): return ""
                         ^^
SyntaxError: invalid syntax
2025-06-26 18:24:48.951 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:25:23.218 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m289[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m286 [0m[2m│   │   │   │   [0m[94mreturn[0m [33m"[0m[33mCần cải thiện: [0m[33m"[0m + kw.replace([33m"[0m[33m_[0m[33m"[0m, [33m"[0m[33m [0m[33m"[0m)                [31m [0m
[31m [0m   [2m287 [0m[2m│   │   [0m[94mreturn[0m [33m"[0m[33mKhông có góp ý tiêu cực[0m[33m"[0m                                       [31m [0m
[31m [0m   [2m288 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m289 [2m│   [0mdf_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked[0m[33m'[0m].apply([1;4mclean_[0m [31m [0m
[31m [0m   [2m290 [0m[2m│   [0mdf_reviews[[33m'[0m[33mSuggestions_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mSuggestions for improvement[0m[33m'[0m [31m [0m
[31m [0m   [2m291 [0m[2m│   [0mdf_reviews[[33m'[0m[33mtext_combined[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] + [33m'[0m[33m [0m[33m'[0m + df_ [31m [0m
[31m [0m   [2m292 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'clean_text'[0m is not defined
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m289[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m286 [0m[2m│   │   │   │   [0m[94mreturn[0m [33m"[0m[33mCần cải thiện: [0m[33m"[0m + kw.replace([33m"[0m[33m_[0m[33m"[0m, [33m"[0m[33m [0m[33m"[0m)                [31m [0m
[31m [0m   [2m287 [0m[2m│   │   [0m[94mreturn[0m [33m"[0m[33mKhông có góp ý tiêu cực[0m[33m"[0m                                       [31m [0m
[31m [0m   [2m288 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m289 [2m│   [0mdf_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked[0m[33m'[0m].apply([1;4mclean_[0m [31m [0m
[31m [0m   [2m290 [0m[2m│   [0mdf_reviews[[33m'[0m[33mSuggestions_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mSuggestions for improvement[0m[33m'[0m [31m [0m
[31m [0m   [2m291 [0m[2m│   [0mdf_reviews[[33m'[0m[33mtext_combined[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] + [33m'[0m[33m [0m[33m'[0m + df_ [31m [0m
[31m [0m   [2m292 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'clean_text'[0m is not defined
2025-06-26 18:28:20.801 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 334
    tfidf = TfidfVectorizer(max_features=5000, ngram_range=(1,2))
IndentationError: unexpected indent
2025-06-26 18:28:20.803 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:30:00.349 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:30:05.829 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 334
    tfidf = TfidfVectorizer(max_features=5000, ngram_range=(1,2))
IndentationError: unexpected indent
2025-06-26 18:30:05.831 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:32:44.228 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:32:55.501 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 349
    smote = SMOTE(random_state=42)
IndentationError: unexpected indent
2025-06-26 18:32:55.504 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:34:06.549 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:34:12.654 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 350
    X_train_balanced, y_train_balanced = smote.fit_resample(X_train, y_train)
IndentationError: unexpected indent
2025-06-26 18:34:12.656 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:34:25.069 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m289[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m286 [0m[2m│   │   │   │   [0m[94mreturn[0m [33m"[0m[33mCần cải thiện: [0m[33m"[0m + kw.replace([33m"[0m[33m_[0m[33m"[0m, [33m"[0m[33m [0m[33m"[0m)                [31m [0m
[31m [0m   [2m287 [0m[2m│   │   [0m[94mreturn[0m [33m"[0m[33mKhông có góp ý tiêu cực[0m[33m"[0m                                       [31m [0m
[31m [0m   [2m288 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m289 [2m│   [0mdf_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked[0m[33m'[0m].apply([1;4mclean_[0m [31m [0m
[31m [0m   [2m290 [0m[2m│   [0mdf_reviews[[33m'[0m[33mSuggestions_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mSuggestions for improvement[0m[33m'[0m [31m [0m
[31m [0m   [2m291 [0m[2m│   [0mdf_reviews[[33m'[0m[33mtext_combined[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] + [33m'[0m[33m [0m[33m'[0m + df_ [31m [0m
[31m [0m   [2m292 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'clean_text'[0m is not defined
2025-06-26 18:44:12.117 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 307
    return " ".join(words)
IndentationError: unexpected indent
2025-06-26 18:44:12.120 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:44:34.933 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:44:40.892 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 74, in get_bytecode
    bytecode = compile(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 307
    return " ".join(words)
    ^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: 'return' outside function
2025-06-26 18:44:40.894 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:44:50.013 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:44:55.993 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 307
    return " ".join(words)
IndentationError: unexpected indent
2025-06-26 18:44:55.995 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:45:21.863 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:45:27.282 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 306
    words = [w for w in text.split() if w not in stopwords and w not in wrong_words and len(w) > 2] return " ".join(words)
                                                                                                    ^^^^^^
SyntaxError: invalid syntax
2025-06-26 18:45:27.284 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:45:47.713 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:45:57.542 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 74, in get_bytecode
    bytecode = compile(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 307
    return " ".join(words)
    ^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: 'return' outside function
2025-06-26 18:45:57.545 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:46:04.652 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:46:15.510 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 307
    return " ".join(words)
IndentationError: unexpected indent
2025-06-26 18:46:15.512 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:47:30.697 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:47:34.990 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 74, in get_bytecode
    bytecode = compile(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 309
    return " ".join(words)
    ^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: 'return' outside function
2025-06-26 18:47:34.992 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:48:22.227 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:48:27.335 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 74, in get_bytecode
    bytecode = compile(  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 327
    return "Cần cải thiện: " + kw.replace("_", " ")
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: 'return' outside function
2025-06-26 18:48:27.337 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-26 18:49:35.564 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-26 18:49:43.429 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m289[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m286 [0m[2m│   │   │   │   [0m[94mreturn[0m [33m"[0m[33mCần cải thiện: [0m[33m"[0m + kw.replace([33m"[0m[33m_[0m[33m"[0m, [33m"[0m[33m [0m[33m"[0m)                [31m [0m
[31m [0m   [2m287 [0m[2m│   │   [0m[94mreturn[0m [33m"[0m[33mKhông có góp ý tiêu cực[0m[33m"[0m                                       [31m [0m
[31m [0m   [2m288 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m289 [2m│   [0mdf_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked[0m[33m'[0m].apply([1;4mclean_[0m [31m [0m
[31m [0m   [2m290 [0m[2m│   [0mdf_reviews[[33m'[0m[33mSuggestions_clean[0m[33m'[0m] = df_reviews[[33m'[0m[33mSuggestions for improvement[0m[33m'[0m [31m [0m
[31m [0m   [2m291 [0m[2m│   [0mdf_reviews[[33m'[0m[33mtext_combined[0m[33m'[0m] = df_reviews[[33m'[0m[33mWhat I liked_clean[0m[33m'[0m] + [33m'[0m[33m [0m[33m'[0m + df_ [31m [0m
[31m [0m   [2m292 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'clean_text'[0m is not defined
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m328[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m325 [0m[2m│   [0mtext_features = tfidf.fit_transform(features[[33m'[0m[33mtext_combined[0m[33m'[0m])             [31m [0m
[31m [0m   [2m326 [0m[2m│   [0m[2m# Kết hợp text features và các features số khác[0m                            [31m [0m
[31m [0m   [2m327 [0m[2m│   [0mnumeric_features = features_processed.drop([33m'[0m[33mtext_combined[0m[33m'[0m, axis=[94m1[0m).values [31m [0m
[31m [0m [31m❱ [0m328 [2m│   [0mX = [1;4mhstack((text_features, numeric_features))[0m                              [31m [0m
[31m [0m   [2m329 [0m[2m│   [0my = target                                                                 [31m [0m
[31m [0m   [2m330 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m331 [0m[2m│   [0mX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=[94m0.2[0m, r [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/scipy/sparse/[0m[1;33m_construct.py[0m:[94m733[0m in [92mhstack[0m     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 730 [0m[2m│   [0m[94mif[0m [96many[0m([96misinstance[0m(b, sparray) [94mfor[0m b [95min[0m blocks.flat):                      [31m [0m
[31m [0m   [2m 731 [0m[2m│   │   [0m[94mreturn[0m _block([blocks], [96mformat[0m, dtype)                                [31m [0m
[31m [0m   [2m 732 [0m[2m│   [0m[94melse[0m:                                                                     [31m [0m
[31m [0m [31m❱ [0m 733 [2m│   │   [0m[94mreturn[0m [1;4m_block([blocks], [0m[1;4;96mformat[0m[1;4m, dtype, return_spmatrix=[0m[1;4;94mTrue[0m[1;4m)[0m          [31m [0m
[31m [0m   [2m 734 [0m                                                                              [31m [0m
[31m [0m   [2m 735 [0m                                                                              [31m [0m
[31m [0m   [2m 736 [0m[94mdef[0m[90m [0m[92mvstack[0m(blocks, [96mformat[0m=[94mNone[0m, dtype=[94mNone[0m):                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/scipy/sparse/[0m[1;33m_construct.py[0m:[94m962[0m in [92m_block[0m     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 959 [0m[2m│   [0mnnz = [96msum[0m(block.nnz [94mfor[0m block [95min[0m blocks[block_mask])                      [31m [0m
[31m [0m   [2m 960 [0m[2m│   [0m[94mif[0m dtype [95mis[0m [94mNone[0m:                                                         [31m [0m
[31m [0m   [2m 961 [0m[2m│   │   [0mall_dtypes = [blk.dtype [94mfor[0m blk [95min[0m blocks[block_mask]]                [31m [0m
[31m [0m [31m❱ [0m 962 [2m│   │   [0mdtype = [1;4mupcast(*all_dtypes)[0m [94mif[0m all_dtypes [94melse[0m [94mNone[0m                   [31m [0m
[31m [0m   [2m 963 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m 964 [0m[2m│   [0mrow_offsets = np.append([94m0[0m, np.cumsum(brow_lengths))                       [31m [0m
[31m [0m   [2m 965 [0m[2m│   [0mcol_offsets = np.append([94m0[0m, np.cumsum(bcol_lengths))                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/scipy/sparse/[0m[1;33m_sputils.py[0m:[94m55[0m in [92mupcast[0m        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 52 [0m[2m│   │   │   [0m_upcast_memo[[96mhash[0m(args)] = t                                       [31m [0m
[31m [0m   [2m 53 [0m[2m│   │   │   [0m[94mreturn[0m t                                                           [31m [0m
[31m [0m   [2m 54 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m 55 [2m│   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mTypeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33mno supported conversion for types: [0m[1;4;33m{[0m[1;4margs[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m            [31m [0m
[31m [0m   [2m 56 [0m                                                                               [31m [0m
[31m [0m   [2m 57 [0m                                                                               [31m [0m
[31m [0m   [2m 58 [0m[94mdef[0m[90m [0m[92mupcast_char[0m(*args):                                                        [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mTypeError: [0mno supported conversion for types: [1m([0m[1;35mdtype[0m[1m([0m[32m'float64'[0m[1m)[0m, [1;35mdtype[0m[1m([0m[32m'O'[0m[1m)[0m[1m)[0m
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m336[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m333 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m334 [0m[2m│   [0msmote = SMOTE(random_state=[94m42[0m)                                             [31m [0m
[31m [0m   [2m335 [0m[2m│   [0mX_train_balanced, y_train_balanced = smote.fit_resample(X_train, y_train)  [31m [0m
[31m [0m [31m❱ [0m336 [2m│   [0m[96mprint[0m([33m"[0m[33mPhân phối sau SMOTE:[0m[33m"[0m, Cou[1;4mnter(y_[0mtrain_balanced))                   [31m [0m
[31m [0m   [2m337 [0m                                                                               [31m [0m
[31m [0m   [2m338 [0m                                                                               [31m [0m
[31m [0m   [2m339 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'Counter'[0m is not defined

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://172.28.0.12:8501
  External URL: http://35.237.217.207:8501


Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.

2025-06-27 04:32:07.269 Port 8501 is already in use
2025-06-27 04:32:13.869 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 509
    binary_data_new = binary_data_new.filter(col("binary_label").isNotNull())
IndentationError: unexpected indent
2025-06-27 04:32:13.875 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 04:32:52.813 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 04:32:57.324 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 509
    binary_data_new = binary_data_new.filter(col("binary_label").isNotNull())
IndentationError: unexpected indent
2025-06-27 04:32:57.326 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 04:33:40.177 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 04:34:55.555 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 04:35:00.062 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 509
    binary_data_new = binary_data_new.filter(col("binary_label").isNotNull())
IndentationError: unexpected indent
2025-06-27 04:35:00.065 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 04:35:43.710 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 04:35:48.051 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 536
    lr_spark = SparkLR(
IndentationError: unexpected indent
2025-06-27 04:35:48.054 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 04:36:47.064 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 04:36:52.730 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 538
    lr_spark = SparkLR(
IndentationError: unexpected indent
2025-06-27 04:36:52.733 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 04:37:13.837 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 04:37:18.287 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 548
    evaluator_auc = BinaryClassificationEvaluator(
IndentationError: unexpected indent
2025-06-27 04:37:18.290 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 04:37:57.669 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 04:38:03.101 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 540
    lr_spark = SparkLR(
IndentationError: unexpected indent
2025-06-27 04:38:03.104 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 04:38:54.679 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 04:38:58.813 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 564
    rf_spark = SparkRF(
IndentationError: unexpected indent
2025-06-27 04:38:58.816 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 04:40:05.454 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 04:40:15.029 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 601
    models_comparison = pd.DataFrame({
IndentationError: unexpected indent
2025-06-27 04:40:15.033 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 04:40:44.328 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
Phân phối của biến Recommend:
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m318[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m315 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m316 [0m[2m│   [0m[2m# Kiểm tra biến mục tiêu "Recommend"[0m                                       [31m [0m
[31m [0m   [2m317 [0m[2m│   [0m[96mprint[0m([33m"[0m[33mPhân phối của biến Recommend:[0m[33m"[0m)                                     [31m [0m
[31m [0m [31m❱ [0m318 [2m│   [0m[96mprint[0m([1;4mdata[0m[[33m'[0m[33mRecommend?[0m[33m'[0m].value_counts())                                   [31m [0m
[31m [0m   [2m319 [0m[2m│   [0m[96mprint[0m([33m"[0m[33mTỷ lệ phần trăm:[0m[33m"[0m)                                                  [31m [0m
[31m [0m   [2m320 [0m[2m│   [0m[96mprint[0m(data[[33m'[0m[33mRecommend?[0m[33m'[0m].value_counts(normalize=[94mTrue[0m) * [94m100[0m)               [31m [0m
[31m [0m   [2m321 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'data'[0m is not defined
Logistic Regression Report:
              precision    recall  f1-score   support

          No       0.48      0.85      0.61       205
         Yes       0.98      0.87      0.92      1479

    accuracy                           0.87      1684
   macro avg       0.73      0.86      0.77      1684
weighted avg       0.92      0.87      0.88      1684

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m354[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m351 [0m[2m│   [0m[96mprint[0m(classification_report(y_test, lr_pred))                              [31m [0m
[31m [0m   [2m352 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m353 [0m[2m│   [0m[2m# ROC curve và AUC - fix parameters[0m                                        [31m [0m
[31m [0m [31m❱ [0m354 [2m│   [0mlr_fpr, lr_tpr, _ = [1;4mroc_curve[0m(y_test, lr_pred_proba, pos_label=[33m"[0m[33mYes[0m[33m"[0m)      [31m [0m
[31m [0m   [2m355 [0m[2m│   [0m[2m# For roc_auc_score, we need to modify the approach[0m                        [31m [0m
[31m [0m   [2m356 [0m[2m│   [0m[2m# Use only the pos_label parameter[0m                                         [31m [0m
[31m [0m   [2m357 [0m[2m│   [0mlr_auc = roc_auc_score(y_test == [33m"[0m[33mYes[0m[33m"[0m, lr_pred_proba)                     [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'roc_curve'[0m is not defined
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
25/06/27 04:47:33 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/06/27 04:47:35 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
Logistic Regression Report:
              precision    recall  f1-score   support

          No       0.48      0.85      0.61       205
         Yes       0.98      0.87      0.92      1479

    accuracy                           0.87      1684
   macro avg       0.73      0.86      0.77      1684
weighted avg       0.92      0.87      0.88      1684

ROC AUC: 0.9371
Random Forest Report:
              precision    recall  f1-score   support

          No       0.65      0.66      0.65       205
         Yes       0.95      0.95      0.95      1479

    accuracy                           0.91      1684
   macro avg       0.80      0.80      0.80      1684
weighted avg       0.92      0.91      0.91      1684

ROC AUC: 0.9222
SVM Report:
              precision    recall  f1-score   support

          No       0.43      0.92      0.58       205
         Yes       0.99      0.83      0.90      1479

    accuracy                           0.84      1684
   macro avg       0.71      0.88      0.74      1684
weighted avg       0.92      0.84      0.86      1684

ROC AUC: 0.9398
Unique values in Recommend? column:
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m420[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m417 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m418 [0m[2m│   [0m[2m# Check the unique values in Recommend? column to understand what's being [0m [31m [0m
[31m [0m   [2m419 [0m[2m│   [0m[96mprint[0m([33m"[0m[33mUnique values in Recommend? column:[0m[33m"[0m)                               [31m [0m
[31m [0m [31m❱ [0m420 [2m│   [0m[96mprint[0m([1;4mdata[0m[[33m"[0m[33mRecommend?[0m[33m"[0m].unique())                                         [31m [0m
[31m [0m   [2m421 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m422 [0m[2m│   [0m[2m# Now let's fix the spark processing pipeline[0m                              [31m [0m
[31m [0m   [2m423 [0m[2m│   [0m[2m# To ensure we have only 2 classes, let's check if there are any null/NA v[0m [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'data'[0m is not defined
Logistic Regression Report:
              precision    recall  f1-score   support

          No       0.48      0.85      0.61       205
         Yes       0.98      0.87      0.92      1479

    accuracy                           0.87      1684
   macro avg       0.73      0.86      0.77      1684
weighted avg       0.92      0.87      0.88      1684

ROC AUC: 0.9371
Random Forest Report:
              precision    recall  f1-score   support

          No       0.65      0.66      0.65       205
         Yes       0.95      0.95      0.95      1479

    accuracy                           0.91      1684
   macro avg       0.80      0.80      0.80      1684
weighted avg       0.92      0.91      0.91      1684

ROC AUC: 0.9222
SVM Report:
              precision    recall  f1-score   support

          No       0.43      0.92      0.58       205
         Yes       0.99      0.83      0.90      1479

    accuracy                           0.84      1684
   macro avg       0.71      0.88      0.74      1684
weighted avg       0.92      0.84      0.86      1684

ROC AUC: 0.9398
Unique values in Recommend? column:
['Yes' 'No']
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m424[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m421 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m422 [0m[2m│   [0m[2m# Now let's fix the spark processing pipeline[0m                              [31m [0m
[31m [0m   [2m423 [0m[2m│   [0m[2m# To ensure we have only 2 classes, let's check if there are any null/NA v[0m [31m [0m
[31m [0m [31m❱ [0m424 [2m│   [0mfiltered_data = [1;4mdata[0m.dropna(subset=[[33m"[0m[33mRecommend?[0m[33m"[0m])                         [31m [0m
[31m [0m   [2m425 [0m[2m│   [0m[96mprint[0m([33mf[0m[33m"[0m[33mOriginal rows: [0m[33m{[0m[96mlen[0m(data)[33m}[0m[33m, After removing NAs: [0m[33m{[0m[96mlen[0m(filtered_data [31m [0m
[31m [0m   [2m426 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m427 [0m[2m│   [0m[2m# Ensure we only have binary values[0m                                        [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'data'[0m is not defined
25/06/27 04:55:59 WARN TaskSetManager: Stage 0 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 0:>                                                          (0 + 1) / 2][Stage 0:>                                                          (0 + 2) / 2]                                                                                25/06/27 04:56:05 WARN TaskSetManager: Stage 3 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 3:>                                                          (0 + 2) / 2][Stage 3:=============================>                             (1 + 1) / 2]                                                                                25/06/27 04:56:13 WARN TaskSetManager: Stage 4 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 4:>                                                          (0 + 2) / 2]                                                                                25/06/27 04:56:15 WARN TaskSetManager: Stage 7 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 7:>                                                          (0 + 2) / 2][Stage 7:=============================>                             (1 + 1) / 2]                                                                                25/06/27 04:56:18 WARN TaskSetManager: Stage 10 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 10:>                                                         (0 + 2) / 2]                                                                                25/06/27 04:56:20 WARN TaskSetManager: Stage 13 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 13:>                                                         (0 + 2) / 2][Stage 13:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:56:23 WARN TaskSetManager: Stage 16 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 16:>                                                         (0 + 2) / 2][Stage 16:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:56:26 WARN TaskSetManager: Stage 17 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 17:>                                                         (0 + 2) / 2]                                                                                25/06/27 04:56:28 WARN TaskSetManager: Stage 20 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 20:>                                                         (0 + 2) / 2][Stage 20:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:56:31 WARN TaskSetManager: Stage 23 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 23:>                                                         (0 + 2) / 2][Stage 23:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:56:35 WARN TaskSetManager: Stage 24 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 24:>                                                         (0 + 2) / 2]                                                                                25/06/27 04:56:38 WARN TaskSetManager: Stage 25 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:38 WARN TaskSetManager: Stage 26 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:39 WARN TaskSetManager: Stage 27 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:39 WARN TaskSetManager: Stage 28 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:39 WARN TaskSetManager: Stage 29 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:40 WARN TaskSetManager: Stage 30 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:40 WARN TaskSetManager: Stage 31 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:41 WARN TaskSetManager: Stage 32 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:41 WARN TaskSetManager: Stage 33 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:41 WARN TaskSetManager: Stage 34 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:42 WARN TaskSetManager: Stage 35 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:56:44 WARN TaskSetManager: Stage 36 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 36:>                                                         (0 + 2) / 2]                                                                                25/06/27 04:56:49 WARN TaskSetManager: Stage 47 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 47:>                                                         (0 + 2) / 2][Stage 47:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:56:51 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
25/06/27 04:56:52 WARN TaskSetManager: Stage 49 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 49:>                                                         (0 + 2) / 2][Stage 49:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:56:55 WARN TaskSetManager: Stage 52 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 52:>                                                         (0 + 1) / 1]                                                                                25/06/27 04:56:57 WARN TaskSetManager: Stage 53 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 53:>                                                         (0 + 2) / 2]                                                                                25/06/27 04:57:00 WARN TaskSetManager: Stage 54 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 54:>                                                         (0 + 2) / 2][Stage 54:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:57:03 WARN TaskSetManager: Stage 56 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 56:>                                                         (0 + 2) / 2]                                                                                25/06/27 04:57:07 WARN TaskSetManager: Stage 58 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 58:>                                                         (0 + 2) / 2][Stage 58:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:57:09 WARN TaskSetManager: Stage 60 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 60:>                                                         (0 + 2) / 2][Stage 60:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:57:11 WARN TaskSetManager: Stage 62 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 62:>                                                         (0 + 2) / 2][Stage 63:>                                                         (0 + 2) / 2]                                                                                25/06/27 04:57:14 WARN TaskSetManager: Stage 64 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 64:>                                                         (0 + 2) / 2][Stage 64:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:57:17 WARN TaskSetManager: Stage 66 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 66:>                                                         (0 + 2) / 2]                                                                                25/06/27 04:57:19 WARN TaskSetManager: Stage 77 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 77:>                                                         (0 + 2) / 2][Stage 77:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:57:22 WARN TaskSetManager: Stage 79 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 79:>                                                         (0 + 1) / 1]                                                                                25/06/27 04:57:23 WARN TaskSetManager: Stage 80 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 80:>                                                         (0 + 2) / 2]                                                                                25/06/27 04:57:25 WARN TaskSetManager: Stage 81 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 81:>                                                         (0 + 2) / 2]                                                                                25/06/27 04:57:30 WARN TaskSetManager: Stage 83 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
[Stage 83:>                                                         (0 + 2) / 2][Stage 83:=============================>                            (1 + 1) / 2]                                                                                25/06/27 04:57:32 WARN TaskSetManager: Stage 85 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:33 WARN TaskSetManager: Stage 87 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:33 WARN TaskSetManager: Stage 89 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:34 WARN TaskSetManager: Stage 91 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:34 WARN TaskSetManager: Stage 93 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:35 WARN TaskSetManager: Stage 95 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:35 WARN TaskSetManager: Stage 97 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:35 WARN TaskSetManager: Stage 99 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:36 WARN TaskSetManager: Stage 101 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:36 WARN TaskSetManager: Stage 103 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:37 WARN TaskSetManager: Stage 105 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:37 WARN TaskSetManager: Stage 107 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:37 WARN TaskSetManager: Stage 109 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:38 WARN TaskSetManager: Stage 111 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:38 WARN TaskSetManager: Stage 113 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:39 WARN TaskSetManager: Stage 115 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:39 WARN TaskSetManager: Stage 117 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:39 WARN TaskSetManager: Stage 119 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:40 WARN TaskSetManager: Stage 121 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:40 WARN TaskSetManager: Stage 123 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:41 WARN TaskSetManager: Stage 125 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:41 WARN TaskSetManager: Stage 127 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:42 WARN TaskSetManager: Stage 129 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:42 WARN TaskSetManager: Stage 131 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:43 WARN TaskSetManager: Stage 133 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:44 WARN TaskSetManager: Stage 135 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:44 WARN TaskSetManager: Stage 137 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:44 WARN TaskSetManager: Stage 139 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:45 WARN TaskSetManager: Stage 141 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:45 WARN TaskSetManager: Stage 143 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:46 WARN TaskSetManager: Stage 145 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:46 WARN TaskSetManager: Stage 147 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:46 WARN TaskSetManager: Stage 149 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:46 WARN TaskSetManager: Stage 151 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:47 WARN TaskSetManager: Stage 153 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:47 WARN TaskSetManager: Stage 155 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:47 WARN TaskSetManager: Stage 157 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:48 WARN TaskSetManager: Stage 159 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:48 WARN TaskSetManager: Stage 161 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:48 WARN TaskSetManager: Stage 163 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:49 WARN TaskSetManager: Stage 165 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:49 WARN TaskSetManager: Stage 167 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:49 WARN TaskSetManager: Stage 169 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:50 WARN TaskSetManager: Stage 171 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:50 WARN TaskSetManager: Stage 173 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:50 WARN TaskSetManager: Stage 175 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:51 WARN TaskSetManager: Stage 177 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:51 WARN TaskSetManager: Stage 179 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:51 WARN TaskSetManager: Stage 181 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 04:57:52 WARN TaskSetManager: Stage 183 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 183:>                                                        (0 + 2) / 2]                                                                                25/06/27 04:57:54 WARN TaskSetManager: Stage 194 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 194:>                                                        (0 + 2) / 2][Stage 194:============================>                            (1 + 1) / 2]                                                                                25/06/27 04:57:57 WARN TaskSetManager: Stage 196 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 196:>                                                        (0 + 2) / 2][Stage 196:============================>                            (1 + 1) / 2]                                                                                25/06/27 04:58:00 WARN TaskSetManager: Stage 197 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 197:>                                                        (0 + 2) / 2][Stage 197:============================>                            (1 + 1) / 2]                                                                                25/06/27 04:58:02 WARN TaskSetManager: Stage 198 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 198:>                                                        (0 + 2) / 2]                                                                                Logistic Regression Report:
              precision    recall  f1-score   support

          No       0.48      0.85      0.61       205
         Yes       0.98      0.87      0.92      1479

    accuracy                           0.87      1684
   macro avg       0.73      0.86      0.77      1684
weighted avg       0.92      0.87      0.88      1684

ROC AUC: 0.9371
Random Forest Report:
              precision    recall  f1-score   support

          No       0.65      0.66      0.65       205
         Yes       0.95      0.95      0.95      1479

    accuracy                           0.91      1684
   macro avg       0.80      0.80      0.80      1684
weighted avg       0.92      0.91      0.91      1684

ROC AUC: 0.9222
SVM Report:
              precision    recall  f1-score   support

          No       0.43      0.92      0.58       205
         Yes       0.99      0.83      0.90      1479

    accuracy                           0.84      1684
   macro avg       0.71      0.88      0.74      1684
weighted avg       0.92      0.84      0.86      1684

ROC AUC: 0.9398
Unique values in Recommend? column:
['Yes' 'No']
Original rows: 8417, After removing NAs: 8417
After filtering to just Yes/No: 8417
Label distribution:
+-----+-----+
|label|count|
+-----+-----+
|  0.0| 7390|
|  1.0| 1027|
+-----+-----+

New binary label distribution:
+------------+-----+
|binary_label|count|
+------------+-----+
|         0.0| 1027|
|         1.0| 7390|
+------------+-----+

Spark LR - AUC: 0.8817, Accuracy: 0.8998
Spark RF - AUC: 0.8299, Accuracy: 0.8806
Spark GBT - AUC: 0.9219, Accuracy: 0.9295
So sánh các mô hình (scikit-learn và PySpark):
                           Model     AUC  Accuracy  Precision  Recall  F1-Score
2                  SVM (sklearn)  0.9398    0.8403     0.9871  0.8289    0.9011
0  Logistic Regression (sklearn)  0.9371    0.8705     0.9766  0.8736    0.9222
1        Random Forest (sklearn)  0.9222    0.9145     0.9525  0.9500    0.9513
5                    GBT (Spark)  0.9219    0.9295     0.9297  0.9951    0.9613
3    Logistic Regression (Spark)  0.8817    0.8998     0.9357  0.9515    0.9436
4          Random Forest (Spark)  0.8299    0.8806     0.8806  1.0000    0.9365
Label encoding mapping: {'No': 0, 'Yes': 1}
XGBoost Report:
              precision    recall  f1-score   support

          No       0.76      0.60      0.67       205
         Yes       0.95      0.97      0.96      1479

    accuracy                           0.93      1684
   macro avg       0.85      0.79      0.82      1684
weighted avg       0.92      0.93      0.93      1684

ROC AUC: 0.9378
So sánh các mô hình (có XGBoost):
                           Model       AUC  ...    Recall  F1-Score
2                  SVM (sklearn)  0.939800  ...  0.828900    0.9011
6                        XGBoost  0.937751  ...  0.973631    0.9600
0  Logistic Regression (sklearn)  0.937100  ...  0.873600    0.9222
1        Random Forest (sklearn)  0.922200  ...  0.950000    0.9513
5                    GBT (Spark)  0.921900  ...  0.995100    0.9613
3    Logistic Regression (Spark)  0.881700  ...  0.951500    0.9436
4          Random Forest (Spark)  0.829900  ...  1.000000    0.9365

[7 rows x 6 columns]
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m734[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m731 [0m[2m│   [0m[96mprint[0m([33m"[0m[33mSo sánh các mô hình (có XGBoost):[0m[33m"[0m)                                 [31m [0m
[31m [0m   [2m732 [0m[2m│   [0m[96mprint[0m(models_comparison.sort_values([33m'[0m[33mAUC[0m[33m'[0m, ascending=[94mFalse[0m))               [31m [0m
[31m [0m   [2m733 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m734 [2m│   [0m[1;4mevaluate_sklearn_model[0m([33m"[0m[33mLogistic Regression[0m[33m"[0m, lr_model, X_test, y_test)    [31m [0m
[31m [0m   [2m735 [0m[2m│   [0mevaluate_sklearn_model([33m"[0m[33mRandom Forest[0m[33m"[0m, rf_model, X_test, y_test)          [31m [0m
[31m [0m   [2m736 [0m[2m│   [0mevaluate_sklearn_model([33m"[0m[33mSVM[0m[33m"[0m, svm_model, X_test, y_test)                   [31m [0m
[31m [0m   [2m737 [0m[2m│   [0mevaluate_sklearn_model([33m"[0m[33mXGBoost[0m[33m"[0m, xgb_model, X_test, y_test)               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'evaluate_sklearn_model'[0m is not defined
25/06/27 05:07:01 WARN TaskSetManager: Stage 199 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 199:>                                                        (0 + 2) / 2][Stage 199:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:02 WARN TaskSetManager: Stage 202 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 202:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:07:03 WARN TaskSetManager: Stage 203 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 203:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:07:04 WARN TaskSetManager: Stage 206 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 206:>                                                        (0 + 2) / 2][Stage 206:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:06 WARN TaskSetManager: Stage 209 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 209:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:07 WARN TaskSetManager: Stage 212 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 212:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:08 WARN TaskSetManager: Stage 215 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 215:>                                                        (0 + 2) / 2][Stage 215:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:10 WARN TaskSetManager: Stage 216 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 216:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:07:12 WARN TaskSetManager: Stage 219 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 219:>                                                        (0 + 2) / 2][Stage 219:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:14 WARN TaskSetManager: Stage 222 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 222:>                                                        (0 + 2) / 2][Stage 222:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:16 WARN TaskSetManager: Stage 223 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 223:>                                                        (0 + 2) / 2][Stage 223:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:17 WARN TaskSetManager: Stage 224 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:17 WARN TaskSetManager: Stage 225 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:17 WARN TaskSetManager: Stage 226 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:18 WARN TaskSetManager: Stage 227 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:18 WARN TaskSetManager: Stage 228 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:18 WARN TaskSetManager: Stage 229 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:18 WARN TaskSetManager: Stage 230 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:18 WARN TaskSetManager: Stage 231 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:18 WARN TaskSetManager: Stage 232 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:18 WARN TaskSetManager: Stage 233 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:19 WARN TaskSetManager: Stage 234 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:20 WARN TaskSetManager: Stage 235 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 235:>                                                        (0 + 2) / 2][Stage 235:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:22 WARN TaskSetManager: Stage 246 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 246:>                                                        (0 + 2) / 2][Stage 246:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:25 WARN TaskSetManager: Stage 248 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 248:>                                                        (0 + 2) / 2][Stage 248:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:28 WARN TaskSetManager: Stage 251 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 251:>                                                        (0 + 1) / 1]                                                                                25/06/27 05:07:29 WARN TaskSetManager: Stage 252 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 252:>                                                        (0 + 2) / 2][Stage 252:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:30 WARN TaskSetManager: Stage 253 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 253:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:07:33 WARN TaskSetManager: Stage 255 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 255:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:07:35 WARN TaskSetManager: Stage 257 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 257:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:07:36 WARN TaskSetManager: Stage 259 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:36 WARN TaskSetManager: Stage 261 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:37 WARN TaskSetManager: Stage 263 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:39 WARN TaskSetManager: Stage 265 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 265:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:07:42 WARN TaskSetManager: Stage 276 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 276:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:07:44 WARN TaskSetManager: Stage 278 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 278:>                                                        (0 + 1) / 1]                                                                                25/06/27 05:07:45 WARN TaskSetManager: Stage 279 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 279:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:07:46 WARN TaskSetManager: Stage 280 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 280:>                                                        (0 + 2) / 2][Stage 280:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:07:48 WARN TaskSetManager: Stage 282 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
[Stage 282:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:07:50 WARN TaskSetManager: Stage 284 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:50 WARN TaskSetManager: Stage 286 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:50 WARN TaskSetManager: Stage 288 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:51 WARN TaskSetManager: Stage 290 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:51 WARN TaskSetManager: Stage 292 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:51 WARN TaskSetManager: Stage 294 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:51 WARN TaskSetManager: Stage 296 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:51 WARN TaskSetManager: Stage 298 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:52 WARN TaskSetManager: Stage 300 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:52 WARN TaskSetManager: Stage 302 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:52 WARN TaskSetManager: Stage 304 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:52 WARN TaskSetManager: Stage 306 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:53 WARN TaskSetManager: Stage 308 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:53 WARN TaskSetManager: Stage 310 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:53 WARN TaskSetManager: Stage 312 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:53 WARN TaskSetManager: Stage 314 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:53 WARN TaskSetManager: Stage 316 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:54 WARN TaskSetManager: Stage 318 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:54 WARN TaskSetManager: Stage 320 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:55 WARN TaskSetManager: Stage 322 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:55 WARN TaskSetManager: Stage 324 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:55 WARN TaskSetManager: Stage 326 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:55 WARN TaskSetManager: Stage 328 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:56 WARN TaskSetManager: Stage 330 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:56 WARN TaskSetManager: Stage 332 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:56 WARN TaskSetManager: Stage 334 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:57 WARN TaskSetManager: Stage 336 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:57 WARN TaskSetManager: Stage 338 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:57 WARN TaskSetManager: Stage 340 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:58 WARN TaskSetManager: Stage 342 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:58 WARN TaskSetManager: Stage 344 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:58 WARN TaskSetManager: Stage 346 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:58 WARN TaskSetManager: Stage 348 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:58 WARN TaskSetManager: Stage 350 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:59 WARN TaskSetManager: Stage 352 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:59 WARN TaskSetManager: Stage 354 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:59 WARN TaskSetManager: Stage 356 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:07:59 WARN TaskSetManager: Stage 358 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:00 WARN TaskSetManager: Stage 360 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:00 WARN TaskSetManager: Stage 362 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:00 WARN TaskSetManager: Stage 364 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:00 WARN TaskSetManager: Stage 366 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:00 WARN TaskSetManager: Stage 368 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:00 WARN TaskSetManager: Stage 370 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:01 WARN TaskSetManager: Stage 372 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:01 WARN TaskSetManager: Stage 374 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:01 WARN TaskSetManager: Stage 376 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:01 WARN TaskSetManager: Stage 378 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:01 WARN TaskSetManager: Stage 380 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:08:02 WARN TaskSetManager: Stage 382 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 382:>                                                        (0 + 2) / 2][Stage 382:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:08:03 WARN TaskSetManager: Stage 393 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 393:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:08:05 WARN TaskSetManager: Stage 395 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 395:>                                                        (0 + 2) / 2][Stage 395:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:08:07 WARN TaskSetManager: Stage 396 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 396:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:08:08 WARN TaskSetManager: Stage 397 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 397:>                                                        (0 + 2) / 2]                                                                                Logistic Regression Report:
              precision    recall  f1-score   support

          No       0.48      0.85      0.61       205
         Yes       0.98      0.87      0.92      1479

    accuracy                           0.87      1684
   macro avg       0.73      0.86      0.77      1684
weighted avg       0.92      0.87      0.88      1684

ROC AUC: 0.9371
Random Forest Report:
              precision    recall  f1-score   support

          No       0.65      0.66      0.65       205
         Yes       0.95      0.95      0.95      1479

    accuracy                           0.91      1684
   macro avg       0.80      0.80      0.80      1684
weighted avg       0.92      0.91      0.91      1684

ROC AUC: 0.9222
SVM Report:
              precision    recall  f1-score   support

          No       0.43      0.92      0.58       205
         Yes       0.99      0.83      0.90      1479

    accuracy                           0.84      1684
   macro avg       0.71      0.88      0.74      1684
weighted avg       0.92      0.84      0.86      1684

ROC AUC: 0.9398
Unique values in Recommend? column:
['Yes' 'No']
Original rows: 8417, After removing NAs: 8417
After filtering to just Yes/No: 8417
Label distribution:
+-----+-----+
|label|count|
+-----+-----+
|  0.0| 7390|
|  1.0| 1027|
+-----+-----+

New binary label distribution:
+------------+-----+
|binary_label|count|
+------------+-----+
|         0.0| 1027|
|         1.0| 7390|
+------------+-----+

Spark LR - AUC: 0.8817, Accuracy: 0.8998
Spark RF - AUC: 0.8299, Accuracy: 0.8806
Spark GBT - AUC: 0.9219, Accuracy: 0.9295
So sánh các mô hình (scikit-learn và PySpark):
                           Model     AUC  Accuracy  Precision  Recall  F1-Score
2                  SVM (sklearn)  0.9398    0.8403     0.9871  0.8289    0.9011
0  Logistic Regression (sklearn)  0.9371    0.8705     0.9766  0.8736    0.9222
1        Random Forest (sklearn)  0.9222    0.9145     0.9525  0.9500    0.9513
5                    GBT (Spark)  0.9219    0.9295     0.9297  0.9951    0.9613
3    Logistic Regression (Spark)  0.8817    0.8998     0.9357  0.9515    0.9436
4          Random Forest (Spark)  0.8299    0.8806     0.8806  1.0000    0.9365
Label encoding mapping: {'No': 0, 'Yes': 1}
XGBoost Report:
              precision    recall  f1-score   support

          No       0.76      0.60      0.67       205
         Yes       0.95      0.97      0.96      1479

    accuracy                           0.93      1684
   macro avg       0.85      0.79      0.82      1684
weighted avg       0.92      0.93      0.93      1684

ROC AUC: 0.9378
So sánh các mô hình (có XGBoost):
                           Model       AUC  ...    Recall  F1-Score
2                  SVM (sklearn)  0.939800  ...  0.828900    0.9011
6                        XGBoost  0.937751  ...  0.973631    0.9600
0  Logistic Regression (sklearn)  0.937100  ...  0.873600    0.9222
1        Random Forest (sklearn)  0.922200  ...  0.950000    0.9513
5                    GBT (Spark)  0.921900  ...  0.995100    0.9613
3    Logistic Regression (Spark)  0.881700  ...  0.951500    0.9436
4          Random Forest (Spark)  0.829900  ...  1.000000    0.9365

[7 rows x 6 columns]
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m809[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m806 [0m[2m│   [0m[96mprint[0m([33m"[0m[33mSo sánh các mô hình (có XGBoost):[0m[33m"[0m)                                 [31m [0m
[31m [0m   [2m807 [0m[2m│   [0m[96mprint[0m(models_comparison.sort_values([33m'[0m[33mAUC[0m[33m'[0m, ascending=[94mFalse[0m))               [31m [0m
[31m [0m   [2m808 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m809 [2m│   [0m[1;4mevaluate_sklearn_model([0m[1;4;33m"[0m[1;4;33mLogistic Regression[0m[1;4;33m"[0m[1;4m, lr_model, X_test, y_test)[0m    [31m [0m
[31m [0m   [2m810 [0m[2m│   [0mevaluate_sklearn_model([33m"[0m[33mRandom Forest[0m[33m"[0m, rf_model, X_test, y_test)          [31m [0m
[31m [0m   [2m811 [0m[2m│   [0mevaluate_sklearn_model([33m"[0m[33mSVM[0m[33m"[0m, svm_model, X_test, y_test)                   [31m [0m
[31m [0m   [2m812 [0m[2m│   [0mevaluate_sklearn_model([33m"[0m[33mXGBoost[0m[33m"[0m, xgb_model, X_test, y_test)               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m732[0m in [92mevaluate_sklearn_model[0m                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m729 [0m[2m│   [0mmodel_results = []                                                         [31m [0m
[31m [0m   [2m730 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m731 [0m[2m│   [0m[94mdef[0m[90m [0m[92mevaluate_sklearn_model[0m(name, model, X_test, y_test, pos_label=[33m"[0m[33mYes[0m[33m"[0m):  [31m [0m
[31m [0m [31m❱ [0m732 [2m│   │   [0my_pred = [1;4mmodel.predict(X_test)[0m                                         [31m [0m
[31m [0m   [2m733 [0m[2m│   │   [0my_proba = model.predict_proba(X_test)[:, [94m1[0m]                            [31m [0m
[31m [0m   [2m734 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m735 [0m[2m│   │   [0mauc = roc_auc_score(y_test == pos_label, y_proba)                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pyspark/ml/[0m[1;33mwrapper.py[0m:[94m465[0m in [92mpredict[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m462 [0m[2;90m│   │   [0m[33m"""[0m                                                                    [31m [0m
[31m [0m   [2m463 [0m[2;33m│   │   [0m[33mPredict label for the given features.[0m                                  [31m [0m
[31m [0m   [2m464 [0m[2;33m│   │   [0m[33m"""[0m                                                                    [31m [0m
[31m [0m [31m❱ [0m465 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m._call_java([0m[1;4;33m"[0m[1;4;33mpredict[0m[1;4;33m"[0m[1;4m, value)[0m                               [31m [0m
[31m [0m   [2m466 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pyspark/ml/[0m[1;33mwrapper.py[0m:[94m71[0m in [92m_call_java[0m       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 68 [0m[2m│   │   [0msc = SparkContext._active_spark_context                                [31m [0m
[31m [0m   [2m 69 [0m[2m│   │   [0m[94massert[0m sc [95mis[0m [95mnot[0m [94mNone[0m                                                  [31m [0m
[31m [0m   [2m 70 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m 71 [2m│   │   [0mjava_args = [1;4m[_py2java(sc, arg) [0m[1;4;94mfor[0m[1;4m arg [0m[1;4;95min[0m[1;4m args][0m                        [31m [0m
[31m [0m   [2m 72 [0m[2m│   │   [0m[94mreturn[0m _java2py(sc, m(*java_args))                                     [31m [0m
[31m [0m   [2m 73 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m 74 [0m[2m│   [0m[1;95m@staticmethod[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pyspark/ml/[0m[1;33mwrapper.py[0m:[94m71[0m in [92m<listcomp>[0m       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 68 [0m[2m│   │   [0msc = SparkContext._active_spark_context                                [31m [0m
[31m [0m   [2m 69 [0m[2m│   │   [0m[94massert[0m sc [95mis[0m [95mnot[0m [94mNone[0m                                                  [31m [0m
[31m [0m   [2m 70 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m 71 [2m│   │   [0mjava_args = [[1;4m_py2java(sc, arg)[0m [94mfor[0m arg [95min[0m args]                        [31m [0m
[31m [0m   [2m 72 [0m[2m│   │   [0m[94mreturn[0m _java2py(sc, m(*java_args))                                     [31m [0m
[31m [0m   [2m 73 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m 74 [0m[2m│   [0m[1;95m@staticmethod[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pyspark/ml/[0m[1;33mcommon.py[0m:[94m90[0m in [92m_py2java[0m          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 87 [0m[2m│   [0m[94melse[0m:                                                                      [31m [0m
[31m [0m   [2m 88 [0m[2m│   │   [0mdata = [96mbytearray[0m(CPickleSerializer().dumps(obj))                       [31m [0m
[31m [0m   [2m 89 [0m[2m│   │   [0m[94massert[0m sc._jvm [95mis[0m [95mnot[0m [94mNone[0m                                             [31m [0m
[31m [0m [31m❱ [0m 90 [2m│   │   [0mobj = [1;4msc._jvm.org.apache.spark.ml.python.MLSerDe.loads(data)[0m           [31m [0m
[31m [0m   [2m 91 [0m[2m│   [0m[94mreturn[0m obj                                                                 [31m [0m
[31m [0m   [2m 92 [0m                                                                               [31m [0m
[31m [0m   [2m 93 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/py4j/[0m[1;33mjava_gateway.py[0m:[94m1322[0m in [92m__call__[0m        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1319 [0m[2m│   │   │   [0mproto.END_COMMAND_PART                                            [31m [0m
[31m [0m   [2m1320 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1321 [0m[2m│   │   [0manswer = [96mself[0m.gateway_client.send_command(command)                    [31m [0m
[31m [0m [31m❱ [0m1322 [2m│   │   [0mreturn_value = [1;4mget_return_value([0m                                      [31m [0m
[31m [0m   [2m1323 [0m[1;2;4m│   │   │   [0m[1;4manswer, [0m[1;4;96mself[0m[1;4m.gateway_client, [0m[1;4;96mself[0m[1;4m.target_id, [0m[1;4;96mself[0m[1;4m.name)[0m           [31m [0m
[31m [0m   [2m1324 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1325 [0m[2m│   │   [0m[94mfor[0m temp_arg [95min[0m temp_args:                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pyspark/errors/exceptions/[0m[1;33mcaptured.py[0m:[94m179[0m in [31m [0m
[31m [0m [92mdeco[0m                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m176 [0m[94mdef[0m[90m [0m[92mcapture_sql_exception[0m(f: Callable[..., Any]) -> Callable[..., Any]:        [31m [0m
[31m [0m   [2m177 [0m[2m│   [0m[94mdef[0m[90m [0m[92mdeco[0m(*a: Any, **kw: Any) -> Any:                                       [31m [0m
[31m [0m   [2m178 [0m[2m│   │   [0m[94mtry[0m:                                                                   [31m [0m
[31m [0m [31m❱ [0m179 [2m│   │   │   [0m[94mreturn[0m f(*a, **kw)                                                 [31m [0m
[31m [0m   [2m180 [0m[2m│   │   [0m[94mexcept[0m Py4JJavaError [94mas[0m e:                                             [31m [0m
[31m [0m   [2m181 [0m[2m│   │   │   [0mconverted = convert_exception(e.java_exception)                    [31m [0m
[31m [0m   [2m182 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m [96misinstance[0m(converted, UnknownException):                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/py4j/[0m[1;33mprotocol.py[0m:[94m326[0m in [92mget_return_value[0m     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m323 [0m[2m│   │   │   [0m[96mtype[0m = answer[[94m1[0m]                                                   [31m [0m
[31m [0m   [2m324 [0m[2m│   │   │   [0mvalue = OUTPUT_CONVERTER[[96mtype[0m](answer[[94m2[0m:], gateway_client)         [31m [0m
[31m [0m   [2m325 [0m[2m│   │   │   [0m[94mif[0m answer[[94m1[0m] == REFERENCE_TYPE:                                    [31m [0m
[31m [0m [31m❱ [0m326 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m Py4JJavaError([0m                                           [31m [0m
[31m [0m   [2m327 [0m[1;2;4m│   │   │   │   │   [0m[1;4;33m"[0m[1;4;33mAn error occurred while calling [0m[1;4;33m{0}[0m[1;4;33m{1}[0m[1;4;33m{2}[0m[1;4;33m.[0m[1;4;33m\n[0m[1;4;33m"[0m[1;4m.[0m            [31m [0m
[31m [0m   [2m328 [0m[1;2;4m│   │   │   │   │   [0m[1;4;96mformat[0m[1;4m(target_id, [0m[1;4;33m"[0m[1;4;33m.[0m[1;4;33m"[0m[1;4m, name), value)[0m                       [31m [0m
[31m [0m   [2m329 [0m[2m│   │   │   [0m[94melse[0m:                                                              [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mPy4JJavaError: [0mAn error occurred while calling 
z:org.apache.spark.ml.python.MLSerDe.loads.
: net.razorvine.pickle.PickleException: expected zero arguments for construction of 
ClassDict [1m([0mfor numpy.dtype[1m)[0m. This happens when an unsupported/unregistered class is 
being unpickled that requires construction arguments. Fix it by registering a custom 
IObjectConstructor for this class.
        at 
[1;35mnet.razorvine.pickle.objects.ClassDictConstructor.construct[0m[1m([0mClassDictConstructor.jav[1;92ma:23[0m
[1m)[0m
        at [1;35mnet.razorvine.pickle.Unpickler.load_reduce[0m[1m([0mUnpickler.jav[1;92ma:759[0m[1m)[0m
        at [1;35mnet.razorvine.pickle.Unpickler.dispatch[0m[1m([0mUnpickler.jav[1;92ma:199[0m[1m)[0m
        at [1;35mnet.razorvine.pickle.Unpickler.load[0m[1m([0mUnpickler.jav[1;92ma:109[0m[1m)[0m
        at [1;35mnet.razorvine.pickle.Unpickler.loads[0m[1m([0mUnpickler.jav[1;92ma:122[0m[1m)[0m
        at [1;35morg.apache.spark.mllib.api.python.SerDeBase.loads[0m[1m([0mPythonMLLibAPI.scal[1;92ma:1326[0m[1m)[0m
        at [1;35morg.apache.spark.ml.python.MLSerDe.loads[0m[1m([0mMLSerDe.scala[1m)[0m
        at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative 
Method[1m)[0m
        at 
java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessorImpl.
jav[1;92ma:62[0m[1m)[0m
        at 
java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethodAcces
sorImpl.jav[1;92ma:43[0m[1m)[0m
        at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:566[0m[1m)[0m
        at [1;35mpy4j.reflection.MethodInvoker.invoke[0m[1m([0mMethodInvoker.jav[1;92ma:244[0m[1m)[0m
        at [1;35mpy4j.reflection.ReflectionEngine.invoke[0m[1m([0mReflectionEngine.jav[1;92ma:374[0m[1m)[0m
        at [1;35mpy4j.Gateway.invoke[0m[1m([0mGateway.jav[1;92ma:282[0m[1m)[0m
        at [1;35mpy4j.commands.AbstractCommand.invokeMethod[0m[1m([0mAbstractCommand.jav[1;92ma:132[0m[1m)[0m
        at [1;35mpy4j.commands.CallCommand.execute[0m[1m([0mCallCommand.jav[1;92ma:79[0m[1m)[0m
        at [1;35mpy4j.ClientServerConnection.waitForCommands[0m[1m([0mClientServerConnection.jav[1;92ma:182[0m[1m)[0m
        at [1;35mpy4j.ClientServerConnection.run[0m[1m([0mClientServerConnection.jav[1;92ma:106[0m[1m)[0m
        at java.base/[1;35mjava.lang.Thread.run[0m[1m([0mThread.jav[1;92ma:829[0m[1m)[0m

25/06/27 05:13:24 WARN TaskSetManager: Stage 398 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 398:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:25 WARN TaskSetManager: Stage 401 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 401:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:28 WARN TaskSetManager: Stage 402 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 402:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:29 WARN TaskSetManager: Stage 405 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 405:>                                                        (0 + 2) / 2][Stage 405:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:13:30 WARN TaskSetManager: Stage 408 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:31 WARN TaskSetManager: Stage 411 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 411:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:32 WARN TaskSetManager: Stage 414 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 414:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:33 WARN TaskSetManager: Stage 415 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:34 WARN TaskSetManager: Stage 418 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 418:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:36 WARN TaskSetManager: Stage 421 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 421:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:37 WARN TaskSetManager: Stage 422 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 422:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:38 WARN TaskSetManager: Stage 423 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:38 WARN TaskSetManager: Stage 424 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:38 WARN TaskSetManager: Stage 425 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:38 WARN TaskSetManager: Stage 426 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:39 WARN TaskSetManager: Stage 427 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:39 WARN TaskSetManager: Stage 428 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:39 WARN TaskSetManager: Stage 429 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:39 WARN TaskSetManager: Stage 430 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:39 WARN TaskSetManager: Stage 431 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:39 WARN TaskSetManager: Stage 432 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:39 WARN TaskSetManager: Stage 433 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:40 WARN TaskSetManager: Stage 434 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 434:>                                                        (0 + 2) / 2][Stage 434:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:13:43 WARN TaskSetManager: Stage 445 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 445:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:46 WARN TaskSetManager: Stage 447 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 447:>                                                        (0 + 2) / 2][Stage 447:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:13:47 WARN TaskSetManager: Stage 450 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 450:>                                                        (0 + 1) / 1]                                                                                25/06/27 05:13:48 WARN TaskSetManager: Stage 451 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 451:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:49 WARN TaskSetManager: Stage 452 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 452:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:13:51 WARN TaskSetManager: Stage 454 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 454:>                                                        (0 + 2) / 2][Stage 454:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:13:53 WARN TaskSetManager: Stage 456 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:53 WARN TaskSetManager: Stage 458 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:54 WARN TaskSetManager: Stage 460 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:55 WARN TaskSetManager: Stage 462 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:13:56 WARN TaskSetManager: Stage 464 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 464:>                                                        (0 + 2) / 2][Stage 464:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:13:58 WARN TaskSetManager: Stage 475 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 475:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:14:02 WARN TaskSetManager: Stage 477 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 477:>                                                        (0 + 1) / 1]                                                                                25/06/27 05:14:03 WARN TaskSetManager: Stage 478 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 478:>                                                        (0 + 2) / 2][Stage 478:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:14:05 WARN TaskSetManager: Stage 479 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 479:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:14:08 WARN TaskSetManager: Stage 481 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
[Stage 481:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:14:11 WARN TaskSetManager: Stage 483 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:11 WARN TaskSetManager: Stage 485 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:12 WARN TaskSetManager: Stage 487 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:12 WARN TaskSetManager: Stage 489 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:13 WARN TaskSetManager: Stage 491 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
[Stage 491:>                                                        (0 + 2) / 2][Stage 491:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:14:14 WARN TaskSetManager: Stage 493 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:14 WARN TaskSetManager: Stage 495 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:15 WARN TaskSetManager: Stage 497 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:15 WARN TaskSetManager: Stage 499 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:16 WARN TaskSetManager: Stage 501 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:17 WARN TaskSetManager: Stage 503 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:17 WARN TaskSetManager: Stage 505 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:17 WARN TaskSetManager: Stage 507 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:17 WARN TaskSetManager: Stage 509 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:18 WARN TaskSetManager: Stage 511 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:18 WARN TaskSetManager: Stage 513 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:18 WARN TaskSetManager: Stage 515 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:19 WARN TaskSetManager: Stage 517 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:19 WARN TaskSetManager: Stage 519 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:20 WARN TaskSetManager: Stage 521 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:20 WARN TaskSetManager: Stage 523 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:21 WARN TaskSetManager: Stage 525 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:21 WARN TaskSetManager: Stage 527 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:21 WARN TaskSetManager: Stage 529 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
[Stage 529:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:14:22 WARN TaskSetManager: Stage 531 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:22 WARN TaskSetManager: Stage 533 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:23 WARN TaskSetManager: Stage 535 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:23 WARN TaskSetManager: Stage 537 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:24 WARN TaskSetManager: Stage 539 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:24 WARN TaskSetManager: Stage 541 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:24 WARN TaskSetManager: Stage 543 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:24 WARN TaskSetManager: Stage 545 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:25 WARN TaskSetManager: Stage 547 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:25 WARN TaskSetManager: Stage 549 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:26 WARN TaskSetManager: Stage 551 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:26 WARN TaskSetManager: Stage 553 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:26 WARN TaskSetManager: Stage 555 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:26 WARN TaskSetManager: Stage 557 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:27 WARN TaskSetManager: Stage 559 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
[Stage 559:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:14:28 WARN TaskSetManager: Stage 561 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:28 WARN TaskSetManager: Stage 563 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:29 WARN TaskSetManager: Stage 565 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:29 WARN TaskSetManager: Stage 567 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:30 WARN TaskSetManager: Stage 569 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:30 WARN TaskSetManager: Stage 571 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:31 WARN TaskSetManager: Stage 573 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:31 WARN TaskSetManager: Stage 575 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:32 WARN TaskSetManager: Stage 577 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:32 WARN TaskSetManager: Stage 579 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:14:33 WARN TaskSetManager: Stage 581 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 581:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:14:35 WARN TaskSetManager: Stage 592 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 592:>                                                        (0 + 2) / 2][Stage 592:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:14:36 WARN TaskSetManager: Stage 594 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 594:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:14:38 WARN TaskSetManager: Stage 595 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 595:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:14:39 WARN TaskSetManager: Stage 596 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 596:>                                                        (0 + 2) / 2]                                                                                Logistic Regression Report:
              precision    recall  f1-score   support

          No       0.48      0.85      0.61       205
         Yes       0.98      0.87      0.92      1479

    accuracy                           0.87      1684
   macro avg       0.73      0.86      0.77      1684
weighted avg       0.92      0.87      0.88      1684

ROC AUC: 0.9371
Random Forest Report:
              precision    recall  f1-score   support

          No       0.65      0.66      0.65       205
         Yes       0.95      0.95      0.95      1479

    accuracy                           0.91      1684
   macro avg       0.80      0.80      0.80      1684
weighted avg       0.92      0.91      0.91      1684

ROC AUC: 0.9222
SVM Report:
              precision    recall  f1-score   support

          No       0.43      0.92      0.58       205
         Yes       0.99      0.83      0.90      1479

    accuracy                           0.84      1684
   macro avg       0.71      0.88      0.74      1684
weighted avg       0.92      0.84      0.86      1684

ROC AUC: 0.9398
Unique values in Recommend? column:
['Yes' 'No']
Original rows: 8417, After removing NAs: 8417
After filtering to just Yes/No: 8417
Label distribution:
+-----+-----+
|label|count|
+-----+-----+
|  0.0| 7390|
|  1.0| 1027|
+-----+-----+

New binary label distribution:
+------------+-----+
|binary_label|count|
+------------+-----+
|         0.0| 1027|
|         1.0| 7390|
+------------+-----+

Spark LR - AUC: 0.8817, Accuracy: 0.8998
Spark RF - AUC: 0.8299, Accuracy: 0.8806
Spark GBT - AUC: 0.9219, Accuracy: 0.9295
So sánh các mô hình (scikit-learn và PySpark):
                           Model     AUC  Accuracy  Precision  Recall  F1-Score
2                  SVM (sklearn)  0.9398    0.8403     0.9871  0.8289    0.9011
0  Logistic Regression (sklearn)  0.9371    0.8705     0.9766  0.8736    0.9222
1        Random Forest (sklearn)  0.9222    0.9145     0.9525  0.9500    0.9513
5                    GBT (Spark)  0.9219    0.9295     0.9297  0.9951    0.9613
3    Logistic Regression (Spark)  0.8817    0.8998     0.9357  0.9515    0.9436
4          Random Forest (Spark)  0.8299    0.8806     0.8806  1.0000    0.9365
Label encoding mapping: {'No': 0, 'Yes': 1}
XGBoost Report:
              precision    recall  f1-score   support

          No       0.76      0.60      0.67       205
         Yes       0.95      0.97      0.96      1479

    accuracy                           0.93      1684
   macro avg       0.85      0.79      0.82      1684
weighted avg       0.92      0.93      0.93      1684

ROC AUC: 0.9378
So sánh các mô hình (có XGBoost):
                           Model       AUC  ...    Recall  F1-Score
2                  SVM (sklearn)  0.939800  ...  0.828900    0.9011
6                        XGBoost  0.937751  ...  0.973631    0.9600
0  Logistic Regression (sklearn)  0.937100  ...  0.873600    0.9222
1        Random Forest (sklearn)  0.922200  ...  0.950000    0.9513
5                    GBT (Spark)  0.921900  ...  0.995100    0.9613
3    Logistic Regression (Spark)  0.881700  ...  0.951500    0.9436
4          Random Forest (Spark)  0.829900  ...  1.000000    0.9365

[7 rows x 6 columns]
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m809[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m806 [0m[2m│   [0m[96mprint[0m([33m"[0m[33mSo sánh các mô hình (có XGBoost):[0m[33m"[0m)                                 [31m [0m
[31m [0m   [2m807 [0m[2m│   [0m[96mprint[0m(models_comparison.sort_values([33m'[0m[33mAUC[0m[33m'[0m, ascending=[94mFalse[0m))               [31m [0m
[31m [0m   [2m808 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m809 [2m│   [0m[1;4mevaluate_sklearn_model([0m[1;4;33m"[0m[1;4;33mLogistic Regression[0m[1;4;33m"[0m[1;4m, lr_model, X_test, y_test)[0m    [31m [0m
[31m [0m   [2m810 [0m[2m│   [0mevaluate_sklearn_model([33m"[0m[33mRandom Forest[0m[33m"[0m, rf_model, X_test, y_test)          [31m [0m
[31m [0m   [2m811 [0m[2m│   [0mevaluate_sklearn_model([33m"[0m[33mSVM[0m[33m"[0m, svm_model, X_test, y_test)                   [31m [0m
[31m [0m   [2m812 [0m[2m│   [0mevaluate_sklearn_model([33m"[0m[33mXGBoost[0m[33m"[0m, xgb_model, X_test, y_test)               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m732[0m in [92mevaluate_sklearn_model[0m                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m729 [0m[2m│   [0mmodel_results = []                                                         [31m [0m
[31m [0m   [2m730 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m731 [0m[2m│   [0m[94mdef[0m[90m [0m[92mevaluate_sklearn_model[0m(name, model, X_test, y_test, pos_label=[33m"[0m[33mYes[0m[33m"[0m):  [31m [0m
[31m [0m [31m❱ [0m732 [2m│   │   [0my_pred = [1;4mmodel.predict(X_test)[0m                                         [31m [0m
[31m [0m   [2m733 [0m[2m│   │   [0my_proba = model.predict_proba(X_test)[:, [94m1[0m]                            [31m [0m
[31m [0m   [2m734 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m735 [0m[2m│   │   [0mauc = roc_auc_score(y_test == pos_label, y_proba)                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pyspark/ml/[0m[1;33mwrapper.py[0m:[94m465[0m in [92mpredict[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m462 [0m[2;90m│   │   [0m[33m"""[0m                                                                    [31m [0m
[31m [0m   [2m463 [0m[2;33m│   │   [0m[33mPredict label for the given features.[0m                                  [31m [0m
[31m [0m   [2m464 [0m[2;33m│   │   [0m[33m"""[0m                                                                    [31m [0m
[31m [0m [31m❱ [0m465 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m._call_java([0m[1;4;33m"[0m[1;4;33mpredict[0m[1;4;33m"[0m[1;4m, value)[0m                               [31m [0m
[31m [0m   [2m466 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pyspark/ml/[0m[1;33mwrapper.py[0m:[94m71[0m in [92m_call_java[0m       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 68 [0m[2m│   │   [0msc = SparkContext._active_spark_context                                [31m [0m
[31m [0m   [2m 69 [0m[2m│   │   [0m[94massert[0m sc [95mis[0m [95mnot[0m [94mNone[0m                                                  [31m [0m
[31m [0m   [2m 70 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m 71 [2m│   │   [0mjava_args = [1;4m[_py2java(sc, arg) [0m[1;4;94mfor[0m[1;4m arg [0m[1;4;95min[0m[1;4m args][0m                        [31m [0m
[31m [0m   [2m 72 [0m[2m│   │   [0m[94mreturn[0m _java2py(sc, m(*java_args))                                     [31m [0m
[31m [0m   [2m 73 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m 74 [0m[2m│   [0m[1;95m@staticmethod[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pyspark/ml/[0m[1;33mwrapper.py[0m:[94m71[0m in [92m<listcomp>[0m       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 68 [0m[2m│   │   [0msc = SparkContext._active_spark_context                                [31m [0m
[31m [0m   [2m 69 [0m[2m│   │   [0m[94massert[0m sc [95mis[0m [95mnot[0m [94mNone[0m                                                  [31m [0m
[31m [0m   [2m 70 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m 71 [2m│   │   [0mjava_args = [[1;4m_py2java(sc, arg)[0m [94mfor[0m arg [95min[0m args]                        [31m [0m
[31m [0m   [2m 72 [0m[2m│   │   [0m[94mreturn[0m _java2py(sc, m(*java_args))                                     [31m [0m
[31m [0m   [2m 73 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m 74 [0m[2m│   [0m[1;95m@staticmethod[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pyspark/ml/[0m[1;33mcommon.py[0m:[94m90[0m in [92m_py2java[0m          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 87 [0m[2m│   [0m[94melse[0m:                                                                      [31m [0m
[31m [0m   [2m 88 [0m[2m│   │   [0mdata = [96mbytearray[0m(CPickleSerializer().dumps(obj))                       [31m [0m
[31m [0m   [2m 89 [0m[2m│   │   [0m[94massert[0m sc._jvm [95mis[0m [95mnot[0m [94mNone[0m                                             [31m [0m
[31m [0m [31m❱ [0m 90 [2m│   │   [0mobj = [1;4msc._jvm.org.apache.spark.ml.python.MLSerDe.loads(data)[0m           [31m [0m
[31m [0m   [2m 91 [0m[2m│   [0m[94mreturn[0m obj                                                                 [31m [0m
[31m [0m   [2m 92 [0m                                                                               [31m [0m
[31m [0m   [2m 93 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/py4j/[0m[1;33mjava_gateway.py[0m:[94m1322[0m in [92m__call__[0m        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1319 [0m[2m│   │   │   [0mproto.END_COMMAND_PART                                            [31m [0m
[31m [0m   [2m1320 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1321 [0m[2m│   │   [0manswer = [96mself[0m.gateway_client.send_command(command)                    [31m [0m
[31m [0m [31m❱ [0m1322 [2m│   │   [0mreturn_value = [1;4mget_return_value([0m                                      [31m [0m
[31m [0m   [2m1323 [0m[1;2;4m│   │   │   [0m[1;4manswer, [0m[1;4;96mself[0m[1;4m.gateway_client, [0m[1;4;96mself[0m[1;4m.target_id, [0m[1;4;96mself[0m[1;4m.name)[0m           [31m [0m
[31m [0m   [2m1324 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1325 [0m[2m│   │   [0m[94mfor[0m temp_arg [95min[0m temp_args:                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pyspark/errors/exceptions/[0m[1;33mcaptured.py[0m:[94m179[0m in [31m [0m
[31m [0m [92mdeco[0m                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m176 [0m[94mdef[0m[90m [0m[92mcapture_sql_exception[0m(f: Callable[..., Any]) -> Callable[..., Any]:        [31m [0m
[31m [0m   [2m177 [0m[2m│   [0m[94mdef[0m[90m [0m[92mdeco[0m(*a: Any, **kw: Any) -> Any:                                       [31m [0m
[31m [0m   [2m178 [0m[2m│   │   [0m[94mtry[0m:                                                                   [31m [0m
[31m [0m [31m❱ [0m179 [2m│   │   │   [0m[94mreturn[0m f(*a, **kw)                                                 [31m [0m
[31m [0m   [2m180 [0m[2m│   │   [0m[94mexcept[0m Py4JJavaError [94mas[0m e:                                             [31m [0m
[31m [0m   [2m181 [0m[2m│   │   │   [0mconverted = convert_exception(e.java_exception)                    [31m [0m
[31m [0m   [2m182 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m [96misinstance[0m(converted, UnknownException):                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/py4j/[0m[1;33mprotocol.py[0m:[94m326[0m in [92mget_return_value[0m     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m323 [0m[2m│   │   │   [0m[96mtype[0m = answer[[94m1[0m]                                                   [31m [0m
[31m [0m   [2m324 [0m[2m│   │   │   [0mvalue = OUTPUT_CONVERTER[[96mtype[0m](answer[[94m2[0m:], gateway_client)         [31m [0m
[31m [0m   [2m325 [0m[2m│   │   │   [0m[94mif[0m answer[[94m1[0m] == REFERENCE_TYPE:                                    [31m [0m
[31m [0m [31m❱ [0m326 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m Py4JJavaError([0m                                           [31m [0m
[31m [0m   [2m327 [0m[1;2;4m│   │   │   │   │   [0m[1;4;33m"[0m[1;4;33mAn error occurred while calling [0m[1;4;33m{0}[0m[1;4;33m{1}[0m[1;4;33m{2}[0m[1;4;33m.[0m[1;4;33m\n[0m[1;4;33m"[0m[1;4m.[0m            [31m [0m
[31m [0m   [2m328 [0m[1;2;4m│   │   │   │   │   [0m[1;4;96mformat[0m[1;4m(target_id, [0m[1;4;33m"[0m[1;4;33m.[0m[1;4;33m"[0m[1;4m, name), value)[0m                       [31m [0m
[31m [0m   [2m329 [0m[2m│   │   │   [0m[94melse[0m:                                                              [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mPy4JJavaError: [0mAn error occurred while calling 
z:org.apache.spark.ml.python.MLSerDe.loads.
: net.razorvine.pickle.PickleException: expected zero arguments for construction of 
ClassDict [1m([0mfor numpy.dtype[1m)[0m. This happens when an unsupported/unregistered class is 
being unpickled that requires construction arguments. Fix it by registering a custom 
IObjectConstructor for this class.
        at 
[1;35mnet.razorvine.pickle.objects.ClassDictConstructor.construct[0m[1m([0mClassDictConstructor.jav[1;92ma:23[0m
[1m)[0m
        at [1;35mnet.razorvine.pickle.Unpickler.load_reduce[0m[1m([0mUnpickler.jav[1;92ma:759[0m[1m)[0m
        at [1;35mnet.razorvine.pickle.Unpickler.dispatch[0m[1m([0mUnpickler.jav[1;92ma:199[0m[1m)[0m
        at [1;35mnet.razorvine.pickle.Unpickler.load[0m[1m([0mUnpickler.jav[1;92ma:109[0m[1m)[0m
        at [1;35mnet.razorvine.pickle.Unpickler.loads[0m[1m([0mUnpickler.jav[1;92ma:122[0m[1m)[0m
        at [1;35morg.apache.spark.mllib.api.python.SerDeBase.loads[0m[1m([0mPythonMLLibAPI.scal[1;92ma:1326[0m[1m)[0m
        at [1;35morg.apache.spark.ml.python.MLSerDe.loads[0m[1m([0mMLSerDe.scala[1m)[0m
        at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative 
Method[1m)[0m
        at 
java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessorImpl.
jav[1;92ma:62[0m[1m)[0m
        at 
java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethodAcces
sorImpl.jav[1;92ma:43[0m[1m)[0m
        at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:566[0m[1m)[0m
        at [1;35mpy4j.reflection.MethodInvoker.invoke[0m[1m([0mMethodInvoker.jav[1;92ma:244[0m[1m)[0m
        at [1;35mpy4j.reflection.ReflectionEngine.invoke[0m[1m([0mReflectionEngine.jav[1;92ma:374[0m[1m)[0m
        at [1;35mpy4j.Gateway.invoke[0m[1m([0mGateway.jav[1;92ma:282[0m[1m)[0m
        at [1;35mpy4j.commands.AbstractCommand.invokeMethod[0m[1m([0mAbstractCommand.jav[1;92ma:132[0m[1m)[0m
        at [1;35mpy4j.commands.CallCommand.execute[0m[1m([0mCallCommand.jav[1;92ma:79[0m[1m)[0m
        at [1;35mpy4j.ClientServerConnection.waitForCommands[0m[1m([0mClientServerConnection.jav[1;92ma:182[0m[1m)[0m
        at [1;35mpy4j.ClientServerConnection.run[0m[1m([0mClientServerConnection.jav[1;92ma:106[0m[1m)[0m
        at java.base/[1;35mjava.lang.Thread.run[0m[1m([0mThread.jav[1;92ma:829[0m[1m)[0m

2025-06-27 05:18:15.161 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 453
    binary_data_new = binary_data_new.filter(col("binary_label").isNotNull())
IndentationError: unexpected indent
2025-06-27 05:18:15.169 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 05:18:58.492 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 05:19:04.933 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 453
    binary_data_new = binary_data_new.filter(col("binary_label").isNotNull())
IndentationError: unexpected indent
2025-06-27 05:19:04.936 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 05:19:24.459 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 05:19:28.778 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 453
    binary_data_new = binary_data_new.filter(col("binary_label").isNotNull())
IndentationError: unexpected indent
2025-06-27 05:19:28.781 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 05:19:52.374 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 05:19:57.125 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 479
    lr_spark = SparkLR(
IndentationError: unexpected indent
2025-06-27 05:19:57.129 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 05:20:08.785 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 05:20:12.923 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 479
    lr_spark = SparkLR(
IndentationError: unexpected indent
2025-06-27 05:20:12.930 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 05:20:24.269 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
2025-06-27 05:20:29.027 Script compilation error
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_runner.py", line 571, in _run_script
    code = self._script_cache.get_bytecode(script_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/script_cache.py", line 72, in get_bytecode
    filebody = magic.add_magic(filebody, script_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/magic.py", line 45, in add_magic
    tree = ast.parse(code, script_path, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/ast.py", line 50, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py", line 485
    lr_model_sklearn = lr_spark.fit(binary_train_new)
IndentationError: unexpected indent
2025-06-27 05:20:29.030 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-06-27 05:21:08.878 Received event for non-watched path: /content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Project 02/Du lieu cung cap/app.py
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m305[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m302 [0m[2m│   [0mlr_model_sklearn.fit(X_train_balanced, y_train_balanced)                   [31m [0m
[31m [0m   [2m303 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m304 [0m[2m│   [0m[2m# Đánh giá[0m                                                                 [31m [0m
[31m [0m [31m❱ [0m305 [2m│   [0mlr_pred = [1;4mlr_model[0m.predict(X_test)                                         [31m [0m
[31m [0m   [2m306 [0m[2m│   [0mlr_pred_proba = lr_model.predict_proba(X_test)[:, [94m1[0m]                       [31m [0m
[31m [0m   [2m307 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m308 [0m[2m│   [0m[96mprint[0m([33m"[0m[33mLogistic Regression Report:[0m[33m"[0m)                                       [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'lr_model'[0m is not defined
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m305[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m302 [0m[2m│   [0mlr_model_sklearn.fit(X_train_balanced, y_train_balanced)                   [31m [0m
[31m [0m   [2m303 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m304 [0m[2m│   [0m[2m# Đánh giá[0m                                                                 [31m [0m
[31m [0m [31m❱ [0m305 [2m│   [0mlr_pred = [1;4mlr_model[0m.predict(X_test)                                         [31m [0m
[31m [0m   [2m306 [0m[2m│   [0mlr_pred_proba = lr_model.predict_proba(X_test)[:, [94m1[0m]                       [31m [0m
[31m [0m   [2m307 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m308 [0m[2m│   [0m[96mprint[0m([33m"[0m[33mLogistic Regression Report:[0m[33m"[0m)                                       [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'lr_model'[0m is not defined
Logistic Regression Report:
              precision    recall  f1-score   support

          No       0.48      0.85      0.61       205
         Yes       0.98      0.87      0.92      1479

    accuracy                           0.87      1684
   macro avg       0.73      0.86      0.77      1684
weighted avg       0.92      0.87      0.88      1684

ROC AUC: 0.9371
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m331[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m328 [0m[2m│   [0mrf_model_sklearn.fit(X_train_balanced, y_train_balanced)                   [31m [0m
[31m [0m   [2m329 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m330 [0m[2m│   [0m[2m# Đánh giá[0m                                                                 [31m [0m
[31m [0m [31m❱ [0m331 [2m│   [0mrf_pred = [1;4mrf_model[0m.predict(X_test)                                         [31m [0m
[31m [0m   [2m332 [0m[2m│   [0mrf_pred_proba = rf_model.predict_proba(X_test)[:, [94m1[0m]                       [31m [0m
[31m [0m   [2m333 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m334 [0m[2m│   [0m[96mprint[0m([33m"[0m[33mRandom Forest Report:[0m[33m"[0m)                                             [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'rf_model'[0m is not defined
Logistic Regression Report:
              precision    recall  f1-score   support

          No       0.48      0.85      0.61       205
         Yes       0.98      0.87      0.92      1479

    accuracy                           0.87      1684
   macro avg       0.73      0.86      0.77      1684
weighted avg       0.92      0.87      0.88      1684

ROC AUC: 0.9371
Random Forest Report:
              precision    recall  f1-score   support

          No       0.65      0.66      0.65       205
         Yes       0.95      0.95      0.95      1479

    accuracy                           0.91      1684
   macro avg       0.80      0.80      0.80      1684
weighted avg       0.92      0.91      0.91      1684

ROC AUC: 0.9222
SVM Report:
              precision    recall  f1-score   support

          No       0.43      0.92      0.58       205
         Yes       0.99      0.83      0.90      1479

    accuracy                           0.84      1684
   macro avg       0.71      0.88      0.74      1684
weighted avg       0.92      0.84      0.86      1684

ROC AUC: 0.9398
Unique values in Recommend? column:
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m378[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m375 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m376 [0m[2m│   [0m[2m# Check the unique values in Recommend? column to understand what's being [0m [31m [0m
[31m [0m   [2m377 [0m[2m│   [0m[96mprint[0m([33m"[0m[33mUnique values in Recommend? column:[0m[33m"[0m)                               [31m [0m
[31m [0m [31m❱ [0m378 [2m│   [0m[96mprint[0m([1;4mdata[0m[[33m"[0m[33mRecommend?[0m[33m"[0m].unique())                                         [31m [0m
[31m [0m   [2m379 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m380 [0m[2m│   [0m[2m# Now let's fix the spark processing pipeline[0m                              [31m [0m
[31m [0m   [2m381 [0m[2m│   [0m[2m# To ensure we have only 2 classes, let's check if there are any null/NA v[0m [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'data'[0m is not defined
25/06/27 05:39:25 WARN TaskSetManager: Stage 597 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 597:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:39:28 WARN TaskSetManager: Stage 600 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 600:>                                                        (0 + 2) / 2][Stage 600:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:39:29 WARN TaskSetManager: Stage 601 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 601:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:39:31 WARN TaskSetManager: Stage 604 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 604:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:39:32 WARN TaskSetManager: Stage 607 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:33 WARN TaskSetManager: Stage 610 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:33 WARN TaskSetManager: Stage 613 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 613:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:39:35 WARN TaskSetManager: Stage 614 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 614:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:39:36 WARN TaskSetManager: Stage 617 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:37 WARN TaskSetManager: Stage 620 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 620:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:39:39 WARN TaskSetManager: Stage 621 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 621:>                                                        (0 + 2) / 2][Stage 621:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:39:40 WARN TaskSetManager: Stage 622 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:41 WARN TaskSetManager: Stage 623 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:41 WARN TaskSetManager: Stage 624 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:41 WARN TaskSetManager: Stage 625 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:41 WARN TaskSetManager: Stage 626 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:41 WARN TaskSetManager: Stage 627 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:41 WARN TaskSetManager: Stage 628 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:41 WARN TaskSetManager: Stage 629 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:41 WARN TaskSetManager: Stage 630 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:41 WARN TaskSetManager: Stage 631 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:42 WARN TaskSetManager: Stage 632 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:43 WARN TaskSetManager: Stage 633 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 633:>                                                        (0 + 2) / 2][Stage 633:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:39:47 WARN TaskSetManager: Stage 644 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 644:>                                                        (0 + 2) / 2][Stage 644:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:39:48 WARN TaskSetManager: Stage 646 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 646:>                                                        (0 + 2) / 2][Stage 646:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:39:50 WARN TaskSetManager: Stage 649 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 649:>                                                        (0 + 1) / 1]                                                                                25/06/27 05:39:51 WARN TaskSetManager: Stage 650 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 650:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:39:52 WARN TaskSetManager: Stage 651 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 651:>                                                        (0 + 2) / 2][Stage 651:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:39:54 WARN TaskSetManager: Stage 653 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 653:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:39:56 WARN TaskSetManager: Stage 655 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:39:56 WARN TaskSetManager: Stage 657 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 657:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:39:57 WARN TaskSetManager: Stage 659 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 659:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:39:58 WARN TaskSetManager: Stage 661 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 661:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:40:02 WARN TaskSetManager: Stage 663 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 663:>                                                        (0 + 2) / 2][Stage 663:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:40:04 WARN TaskSetManager: Stage 674 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 674:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:40:06 WARN TaskSetManager: Stage 676 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:07 WARN TaskSetManager: Stage 677 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 677:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:40:08 WARN TaskSetManager: Stage 678 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 678:>                                                        (0 + 2) / 2][Stage 678:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:40:10 WARN TaskSetManager: Stage 680 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
[Stage 680:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:40:12 WARN TaskSetManager: Stage 682 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:12 WARN TaskSetManager: Stage 684 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:12 WARN TaskSetManager: Stage 686 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:12 WARN TaskSetManager: Stage 688 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:13 WARN TaskSetManager: Stage 690 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:13 WARN TaskSetManager: Stage 692 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:14 WARN TaskSetManager: Stage 694 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:14 WARN TaskSetManager: Stage 696 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:14 WARN TaskSetManager: Stage 698 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:14 WARN TaskSetManager: Stage 700 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:15 WARN TaskSetManager: Stage 702 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:15 WARN TaskSetManager: Stage 704 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:16 WARN TaskSetManager: Stage 706 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:16 WARN TaskSetManager: Stage 708 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:16 WARN TaskSetManager: Stage 710 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:17 WARN TaskSetManager: Stage 712 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:17 WARN TaskSetManager: Stage 714 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:17 WARN TaskSetManager: Stage 716 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:17 WARN TaskSetManager: Stage 718 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:17 WARN TaskSetManager: Stage 720 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:17 WARN TaskSetManager: Stage 722 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:18 WARN TaskSetManager: Stage 724 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:18 WARN TaskSetManager: Stage 726 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:18 WARN TaskSetManager: Stage 728 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:18 WARN TaskSetManager: Stage 730 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:18 WARN TaskSetManager: Stage 732 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:18 WARN TaskSetManager: Stage 734 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:19 WARN TaskSetManager: Stage 736 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:19 WARN TaskSetManager: Stage 738 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:19 WARN TaskSetManager: Stage 740 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:19 WARN TaskSetManager: Stage 742 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:19 WARN TaskSetManager: Stage 744 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:19 WARN TaskSetManager: Stage 746 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:20 WARN TaskSetManager: Stage 748 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:20 WARN TaskSetManager: Stage 750 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:20 WARN TaskSetManager: Stage 752 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:20 WARN TaskSetManager: Stage 754 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:20 WARN TaskSetManager: Stage 756 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:20 WARN TaskSetManager: Stage 758 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:21 WARN TaskSetManager: Stage 760 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:21 WARN TaskSetManager: Stage 762 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:21 WARN TaskSetManager: Stage 764 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:21 WARN TaskSetManager: Stage 766 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:21 WARN TaskSetManager: Stage 768 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:21 WARN TaskSetManager: Stage 770 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:22 WARN TaskSetManager: Stage 772 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:22 WARN TaskSetManager: Stage 774 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:22 WARN TaskSetManager: Stage 776 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:22 WARN TaskSetManager: Stage 778 contains a task of very large size (3531 KiB). The maximum recommended task size is 1000 KiB.
25/06/27 05:40:23 WARN TaskSetManager: Stage 780 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 780:>                                                        (0 + 2) / 2][Stage 780:============================>                            (1 + 1) / 2]                                                                                25/06/27 05:40:24 WARN TaskSetManager: Stage 791 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 791:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:40:25 WARN TaskSetManager: Stage 793 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 793:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:40:27 WARN TaskSetManager: Stage 794 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 794:>                                                        (0 + 2) / 2]                                                                                25/06/27 05:40:28 WARN TaskSetManager: Stage 795 contains a task of very large size (3530 KiB). The maximum recommended task size is 1000 KiB.
[Stage 795:>                                                        (0 + 2) / 2]                                                                                Logistic Regression Report:
              precision    recall  f1-score   support

          No       0.48      0.85      0.61       205
         Yes       0.98      0.87      0.92      1479

    accuracy                           0.87      1684
   macro avg       0.73      0.86      0.77      1684
weighted avg       0.92      0.87      0.88      1684

ROC AUC: 0.9371
Random Forest Report:
              precision    recall  f1-score   support

          No       0.65      0.66      0.65       205
         Yes       0.95      0.95      0.95      1479

    accuracy                           0.91      1684
   macro avg       0.80      0.80      0.80      1684
weighted avg       0.92      0.91      0.91      1684

ROC AUC: 0.9222
SVM Report:
              precision    recall  f1-score   support

          No       0.43      0.92      0.58       205
         Yes       0.99      0.83      0.90      1479

    accuracy                           0.84      1684
   macro avg       0.71      0.88      0.74      1684
weighted avg       0.92      0.84      0.86      1684

ROC AUC: 0.9398
Unique values in Recommend? column:
['Yes' 'No']
Original rows: 8417, After removing NAs: 8417
After filtering to just Yes/No: 8417
Label distribution:
+-----+-----+
|label|count|
+-----+-----+
|  0.0| 7390|
|  1.0| 1027|
+-----+-----+

New binary label distribution:
+------------+-----+
|binary_label|count|
+------------+-----+
|         0.0| 1027|
|         1.0| 7390|
+------------+-----+

Spark LR - AUC: 0.8817, Accuracy: 0.8998
Spark RF - AUC: 0.8299, Accuracy: 0.8806
Spark GBT - AUC: 0.9219, Accuracy: 0.9295
So sánh các mô hình (scikit-learn và PySpark):
                           Model     AUC  Accuracy  Precision  Recall  F1-Score
2                  SVM (sklearn)  0.9398    0.8403     0.9871  0.8289    0.9011
0  Logistic Regression (sklearn)  0.9371    0.8705     0.9766  0.8736    0.9222
1        Random Forest (sklearn)  0.9222    0.9145     0.9525  0.9500    0.9513
5                    GBT (Spark)  0.9219    0.9295     0.9297  0.9951    0.9613
3    Logistic Regression (Spark)  0.8817    0.8998     0.9357  0.9515    0.9436
4          Random Forest (Spark)  0.8299    0.8806     0.8806  1.0000    0.9365
Label encoding mapping: {'No': 0, 'Yes': 1}
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m654[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m651 [0m[2m│   [0mxgb_model_sklearn.fit(X_train_balanced, y_train_balanced_encoded)          [31m [0m
[31m [0m   [2m652 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m653 [0m[2m│   [0m[2m# Đánh giá[0m                                                                 [31m [0m
[31m [0m [31m❱ [0m654 [2m│   [0mxgb_pred_encoded = [1;4mxgb_model[0m.predict(X_test)                               [31m [0m
[31m [0m   [2m655 [0m[2m│   [0mxgb_pred = label_encoder.inverse_transform(xgb_pred_encoded)  [2m# Convert ba[0m [31m [0m
[31m [0m   [2m656 [0m[2m│   [0mxgb_pred_proba = xgb_model.predict_proba(X_test)[:, [94m1[0m]  [2m# Probability of t[0m [31m [0m
[31m [0m   [2m657 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'xgb_model'[0m is not defined

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m413[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m410 [0m[2m│   [0m[94mfrom[0m[90m [0m[4;96msklearn[0m[4;96m.[0m[4;96mmetrics[0m[90m [0m[94mimport[0m roc_curve, roc_auc_score, f1_score             [31m [0m
[31m [0m   [2m411 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m412 [0m[2m│   [0m[2m# Load pre-trained models and encoders[0m                                     [31m [0m
[31m [0m [31m❱ [0m413 [2m│   [0mxgb_model = [1;4mjoblib.load([0m[1;4;33m"[0m[1;4;33mxgb_model.pkl[0m[1;4;33m"[0m[1;4m)[0m                                   [31m [0m
[31m [0m   [2m414 [0m[2m│   [0mtfidf_vectorizer = joblib.load([33m"[0m[33mtfidf_vectorizer.pkl[0m[33m"[0m)                     [31m [0m
[31m [0m   [2m415 [0m[2m│   [0monehot_encoder = joblib.load([33m"[0m[33monehot_encoder.pkl[0m[33m"[0m)                         [31m [0m
[31m [0m   [2m416 [0m[2m│   [0mlabel_encoder = joblib.load([33m"[0m[33mlabel_encoder.pkl[0m[33m"[0m)                           [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/joblib/[0m[1;33mnumpy_pickle.py[0m:[94m735[0m in [92mload[0m           [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m732 [0m[2m│   │   [0m[94mwith[0m _validate_fileobject_and_memmap(fobj, filename, mmap_mode) [94mas[0m (fo [31m [0m
[31m [0m   [2m733 [0m[2m│   │   │   [0mobj = _unpickle(fobj, ensure_native_byte_order=ensure_native_byte_ [31m [0m
[31m [0m   [2m734 [0m[2m│   [0m[94melse[0m:                                                                      [31m [0m
[31m [0m [31m❱ [0m735 [2m│   │   [0m[94mwith[0m [1;4;96mopen[0m[1;4m(filename, [0m[1;4;33m"[0m[1;4;33mrb[0m[1;4;33m"[0m[1;4m)[0m [94mas[0m f:                                        [31m [0m
[31m [0m   [2m736 [0m[2m│   │   │   [0m[94mwith[0m _validate_fileobject_and_memmap(f, filename, mmap_mode) [94mas[0m (  [31m [0m
[31m [0m   [2m737 [0m[2m│   │   │   │   [0mfobj,                                                          [31m [0m
[31m [0m   [2m738 [0m[2m│   │   │   │   [0mvalidated_mmap_mode,                                           [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mFileNotFoundError: [0m[1m[[0mErrno [1;36m2[0m[1m][0m No such file or directory: [32m'xgb_model.pkl'[0m

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m421[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m418 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m419 [0m[2m│   [0m[2m# Load pre-trained models and encoders[0m                                     [31m [0m
[31m [0m   [2m420 [0m[2m│   [0mxgb_model = joblib.load([33m"[0m[33mxgb_model.pkl[0m[33m"[0m)                                   [31m [0m
[31m [0m [31m❱ [0m421 [2m│   [0mtfidf_vectorizer = [1;4mjoblib.load([0m[1;4;33m"[0m[1;4;33mtfidf_vectorizer.pkl[0m[1;4;33m"[0m[1;4m)[0m                     [31m [0m
[31m [0m   [2m422 [0m[2m│   [0monehot_encoder = joblib.load([33m"[0m[33monehot_encoder.pkl[0m[33m"[0m)                         [31m [0m
[31m [0m   [2m423 [0m[2m│   [0mlabel_encoder = joblib.load([33m"[0m[33mlabel_encoder.pkl[0m[33m"[0m)                           [31m [0m
[31m [0m   [2m424 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/joblib/[0m[1;33mnumpy_pickle.py[0m:[94m735[0m in [92mload[0m           [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m732 [0m[2m│   │   [0m[94mwith[0m _validate_fileobject_and_memmap(fobj, filename, mmap_mode) [94mas[0m (fo [31m [0m
[31m [0m   [2m733 [0m[2m│   │   │   [0mobj = _unpickle(fobj, ensure_native_byte_order=ensure_native_byte_ [31m [0m
[31m [0m   [2m734 [0m[2m│   [0m[94melse[0m:                                                                      [31m [0m
[31m [0m [31m❱ [0m735 [2m│   │   [0m[94mwith[0m [1;4;96mopen[0m[1;4m(filename, [0m[1;4;33m"[0m[1;4;33mrb[0m[1;4;33m"[0m[1;4m)[0m [94mas[0m f:                                        [31m [0m
[31m [0m   [2m736 [0m[2m│   │   │   [0m[94mwith[0m _validate_fileobject_and_memmap(f, filename, mmap_mode) [94mas[0m (  [31m [0m
[31m [0m   [2m737 [0m[2m│   │   │   │   [0mfobj,                                                          [31m [0m
[31m [0m   [2m738 [0m[2m│   │   │   │   [0mvalidated_mmap_mode,                                           [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mFileNotFoundError: [0m[1m[[0mErrno [1;36m2[0m[1m][0m No such file or directory: [32m'tfidf_vectorizer.pkl'[0m

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m418[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m415 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m416 [0m[2m│   [0m[2m# Save the label encoder[0m                                                   [31m [0m
[31m [0m   [2m417 [0m[2m│   [0mjoblib.dump(label_encoder, [33m'[0m[33mlabel_encoder.pkl[0m[33m'[0m)                            [31m [0m
[31m [0m [31m❱ [0m418 [2m│   [0mjoblib.dump([1;4mtfidf_vectorizer[0m, [33m"[0m[33mtfidf_vectorizer.pkl[0m[33m"[0m)                      [31m [0m
[31m [0m   [2m419 [0m[2m│   [0mjoblib.dump(onehot_encoder, [33m"[0m[33monehot_encoder.pkl[0m[33m"[0m)                          [31m [0m
[31m [0m   [2m420 [0m                                                                               [31m [0m
[31m [0m   [2m421 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mNameError: [0mname [32m'tfidf_vectorizer'[0m is not defined

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m416[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m413 [0m[2m│   [0m[2m#chuyển OneHotEncoder[0m                                                      [31m [0m
[31m [0m   [2m414 [0m[2m│   [0m[94mfrom[0m[90m [0m[4;96msklearn[0m[4;96m.[0m[4;96mpreprocessing[0m[90m [0m[94mimport[0m OneHotEncoder                            [31m [0m
[31m [0m   [2m415 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m416 [2m│   [0monehot_encoder = [1;4mOneHotEncoder(drop=[0m[1;4;33m'[0m[1;4;33mfirst[0m[1;4;33m'[0m[1;4m, sparse=[0m[1;4;94mFalse[0m[1;4m, handle_unknown=[0m [31m [0m
[31m [0m   [2m417 [0m[2m│   [0mcat_features = features[[[33m'[0m[33mCompany Type[0m[33m'[0m, [33m'[0m[33mCompany size[0m[33m'[0m]]                  [31m [0m
[31m [0m   [2m418 [0m[2m│   [0mcat_encoded = onehot_encoder.fit_transform(cat_features)                   [31m [0m
[31m [0m   [2m419 [0m                                                                               [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mTypeError: [0m[1;35mOneHotEncoder.__init__[0m[1m([0m[1m)[0m got an unexpected keyword argument [32m'sparse'[0m

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/core/indexes/[0m[1;33mbase.py[0m:[94m3805[0m in [92mget_loc[0m  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m3802 [0m[2;33m│   │   [0m[33m"""[0m                                                                   [31m [0m
[31m [0m   [2m3803 [0m[2m│   │   [0mcasted_key = [96mself[0m._maybe_cast_indexer(key)                            [31m [0m
[31m [0m   [2m3804 [0m[2m│   │   [0m[94mtry[0m:                                                                  [31m [0m
[31m [0m [31m❱ [0m3805 [2m│   │   │   [0m[94mreturn[0m [96mself[0m._engine.get_loc(casted_key)                           [31m [0m
[31m [0m   [2m3806 [0m[2m│   │   [0m[94mexcept[0m [96mKeyError[0m [94mas[0m err:                                               [31m [0m
[31m [0m   [2m3807 [0m[2m│   │   │   [0m[94mif[0m [96misinstance[0m(casted_key, [96mslice[0m) [95mor[0m (                             [31m [0m
[31m [0m   [2m3808 [0m[2m│   │   │   │   [0m[96misinstance[0m(casted_key, abc.Iterable)                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m in [92mpandas._libs.index.IndexEngine.get_loc[0m:[94m167[0m                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m in [92mpandas._libs.index.IndexEngine.get_loc[0m:[94m196[0m                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m in [92mpandas._libs.hashtable.PyObjectHashTable.get_item[0m:[94m7081[0m                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m in [92mpandas._libs.hashtable.PyObjectHashTable.get_item[0m:[94m7089[0m                            [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mKeyError: [0m[32m'Company Name'[0m

[3mThe above exception was the direct cause of the following exception:[0m

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m453[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m450 [0m[2m│   [0mcompany_name_input = st.text_input([33m"[0m[33mNhập tên công ty[0m[33m"[0m)                     [31m [0m
[31m [0m   [2m451 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m452 [0m[2m│   [0m[94mif[0m company_name_input.strip() != [33m"[0m[33m"[0m:                                       [31m [0m
[31m [0m [31m❱ [0m453 [2m│   │   [0mmatched = df_reviews[[1;4mdf_reviews[[0m[1;4;33m"[0m[1;4;33mCompany Name[0m[1;4;33m"[0m[1;4m][0m.str.contains(company_n [31m [0m
[31m [0m   [2m454 [0m[2m│   │   [0m[94mif[0m [95mnot[0m matched.empty:                                                  [31m [0m
[31m [0m   [2m455 [0m[2m│   │   │   [0mst.success([33mf[0m[33m"[0m[33m🔍 Tìm thấy [0m[33m{[0m[96mlen[0m(matched)[33m}[0m[33m kết quả[0m[33m"[0m)                  [31m [0m
[31m [0m   [2m456 [0m[2m│   │   │   [0mst.dataframe(matched[[[33m"[0m[33mCompany Name[0m[33m"[0m, [33m"[0m[33mCompany Type[0m[33m"[0m, [33m"[0m[33mCompany siz[0m [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/core/[0m[1;33mframe.py[0m:[94m4102[0m in [92m__getitem__[0m     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 4099 [0m[2m│   │   [0m[94mif[0m is_single_key:                                                    [31m [0m
[31m [0m   [2m 4100 [0m[2m│   │   │   [0m[94mif[0m [96mself[0m.columns.nlevels > [94m1[0m:                                     [31m [0m
[31m [0m   [2m 4101 [0m[2m│   │   │   │   [0m[94mreturn[0m [96mself[0m._getitem_multilevel(key)                         [31m [0m
[31m [0m [31m❱ [0m 4102 [2m│   │   │   [0mindexer = [1;4;96mself[0m[1;4m.columns.get_loc(key)[0m                              [31m [0m
[31m [0m   [2m 4103 [0m[2m│   │   │   [0m[94mif[0m is_integer(indexer):                                          [31m [0m
[31m [0m   [2m 4104 [0m[2m│   │   │   │   [0mindexer = [indexer]                                          [31m [0m
[31m [0m   [2m 4105 [0m[2m│   │   [0m[94melse[0m:                                                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/core/indexes/[0m[1;33mbase.py[0m:[94m3812[0m in [92mget_loc[0m  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m3809 [0m[2m│   │   │   │   [0m[95mand[0m [96many[0m([96misinstance[0m(x, [96mslice[0m) [94mfor[0m x [95min[0m casted_key)             [31m [0m
[31m [0m   [2m3810 [0m[2m│   │   │   [0m):                                                                [31m [0m
[31m [0m   [2m3811 [0m[2m│   │   │   │   [0m[94mraise[0m InvalidIndexError(key)                                  [31m [0m
[31m [0m [31m❱ [0m3812 [2m│   │   │   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mKeyError[0m[1;4m(key) [0m[1;4;94mfrom[0m[1;4;90m [0m[1;4;96merr[0m                                      [31m [0m
[31m [0m   [2m3813 [0m[2m│   │   [0m[94mexcept[0m [96mTypeError[0m:                                                     [31m [0m
[31m [0m   [2m3814 [0m[2m│   │   │   [0m[2m# If we have a listlike key, _check_indexing_error will raise[0m     [31m [0m
[31m [0m   [2m3815 [0m[2m│   │   │   [0m[2m#  InvalidIndexError. Otherwise we fall through and re-raise[0m      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mKeyError: [0m[32m'Company Name'[0m

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198

Model Performance Comparison:
                 Model       AUC  Accuracy  Precision    Recall  F1-Score
1                  SVM  0.939762  0.840261   0.987118  0.828938  0.901139
2              XGBoost  0.937751  0.928741   0.946746  0.973631  0.960000
0  Logistic Regression  0.937077  0.870546   0.976568  0.873563  0.922198
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/core/indexes/[0m[1;33mbase.py[0m:[94m3805[0m in [92mget_loc[0m  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m3802 [0m[2;33m│   │   [0m[33m"""[0m                                                                   [31m [0m
[31m [0m   [2m3803 [0m[2m│   │   [0mcasted_key = [96mself[0m._maybe_cast_indexer(key)                            [31m [0m
[31m [0m   [2m3804 [0m[2m│   │   [0m[94mtry[0m:                                                                  [31m [0m
[31m [0m [31m❱ [0m3805 [2m│   │   │   [0m[94mreturn[0m [96mself[0m._engine.get_loc(casted_key)                           [31m [0m
[31m [0m   [2m3806 [0m[2m│   │   [0m[94mexcept[0m [96mKeyError[0m [94mas[0m err:                                               [31m [0m
[31m [0m   [2m3807 [0m[2m│   │   │   [0m[94mif[0m [96misinstance[0m(casted_key, [96mslice[0m) [95mor[0m (                             [31m [0m
[31m [0m   [2m3808 [0m[2m│   │   │   │   [0m[96misinstance[0m(casted_key, abc.Iterable)                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m in [92mpandas._libs.index.IndexEngine.get_loc[0m:[94m167[0m                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m in [92mpandas._libs.index.IndexEngine.get_loc[0m:[94m196[0m                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m in [92mpandas._libs.hashtable.PyObjectHashTable.get_item[0m:[94m7081[0m                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m in [92mpandas._libs.hashtable.PyObjectHashTable.get_item[0m:[94m7089[0m                            [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mKeyError: [0m[32m'Company Name'[0m

[3mThe above exception was the direct cause of the following exception:[0m

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/gdrive/MyDrive/DL07_DATN_k304_T37_NguyenQuynhOanhThao_LeNguyenMinhQuang/Pro[0m [31m [0m
[31m [0m [2;33mject 02/Du lieu cung cap/[0m[1;33mapp.py[0m:[94m452[0m in [92m<module>[0m                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m449 [0m[2m│   [0mst.subheader([33m"[0m[33m🔎 Tra cứu thông tin công ty[0m[33m"[0m)                               [31m [0m
[31m [0m   [2m450 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m451 [0m[2m│   [0m[2m# Get unique company names[0m                                                 [31m [0m
[31m [0m [31m❱ [0m452 [2m│   [0mcompany_names = [1;4mdf_reviews[[0m[1;4;33m"[0m[1;4;33mCompany Name[0m[1;4;33m"[0m[1;4m][0m.dropna().unique()               [31m [0m
[31m [0m   [2m453 [0m[2m│   [0mselected_name = st.selectbox([33m"[0m[33mChọn tên công ty[0m[33m"[0m, [96msorted[0m(company_names))    [31m [0m
[31m [0m   [2m454 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m455 [0m[2m│   [0m[2m# Display company info if selected[0m                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/core/[0m[1;33mframe.py[0m:[94m4102[0m in [92m__getitem__[0m     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 4099 [0m[2m│   │   [0m[94mif[0m is_single_key:                                                    [31m [0m
[31m [0m   [2m 4100 [0m[2m│   │   │   [0m[94mif[0m [96mself[0m.columns.nlevels > [94m1[0m:                                     [31m [0m
[31m [0m   [2m 4101 [0m[2m│   │   │   │   [0m[94mreturn[0m [96mself[0m._getitem_multilevel(key)                         [31m [0m
[31m [0m [31m❱ [0m 4102 [2m│   │   │   [0mindexer = [1;4;96mself[0m[1;4m.columns.get_loc(key)[0m                              [31m [0m
[31m [0m   [2m 4103 [0m[2m│   │   │   [0m[94mif[0m is_integer(indexer):                                          [31m [0m
[31m [0m   [2m 4104 [0m[2m│   │   │   │   [0mindexer = [indexer]                                          [31m [0m
[31m [0m   [2m 4105 [0m[2m│   │   [0m[94melse[0m:                                                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/pandas/core/indexes/[0m[1;33mbase.py[0m:[94m3812[0m in [92mget_loc[0m  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m3809 [0m[2m│   │   │   │   [0m[95mand[0m [96many[0m([96misinstance[0m(x, [96mslice[0m) [94mfor[0m x [95min[0m casted_key)             [31m [0m
[31m [0m   [2m3810 [0m[2m│   │   │   [0m):                                                                [31m [0m
[31m [0m   [2m3811 [0m[2m│   │   │   │   [0m[94mraise[0m InvalidIndexError(key)                                  [31m [0m
[31m [0m [31m❱ [0m3812 [2m│   │   │   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mKeyError[0m[1;4m(key) [0m[1;4;94mfrom[0m[1;4;90m [0m[1;4;96merr[0m                                      [31m [0m
[31m [0m   [2m3813 [0m[2m│   │   [0m[94mexcept[0m [96mTypeError[0m:                                                     [31m [0m
[31m [0m   [2m3814 [0m[2m│   │   │   [0m[2m# If we have a listlike key, _check_indexing_error will raise[0m     [31m [0m
[31m [0m   [2m3815 [0m[2m│   │   │   [0m[2m#  InvalidIndexError. Otherwise we fall through and re-raise[0m      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mKeyError: [0m[32m'Company Name'[0m

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://172.28.0.12:8501
  External URL: http://34.138.176.138:8501


Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.

2025-06-28 01:45:35.854 Port 8501 is already in use

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.

2025-06-28 01:45:54.635 Port 8501 is already in use

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.

2025-06-28 01:49:02.100 Port 8501 is already in use

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.

2025-06-28 01:49:15.212 Port 8501 is already in use

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.

2025-06-28 01:50:38.996 Port 8501 is already in use
